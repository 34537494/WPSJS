{"version":3,"sources":["actions/index.js","components/WebAddinCommon/DynamicModal/index.js","components/WebAddinContext/index.js","components/WebAddinCommon/UploadDocContent/index.js","components/ribbon.js","components/WebAddinSignInOut/index.js","components/App.js","reducers/index.js","sources/users.js","sagas/index.js","index.js","settings.js","components/WebAddinCommon/index.js","js/util.js"],"names":["createActions","USER","LOGIN","tel","email","password","remeber","captcha","SIGNUP","username","owner","sharer","LOGOUT","CHECKLOGIN","CHECKLOGIN_FINISHED","LOGIN_FINISHED","SIGNUP_FINISHED","LOGOUT_FINISHED","SHOW_MODAL","HIDE_MODAL","user","login","signup","logout","checklogin","checkloginFinished","loginFinished","signupFinished","logoutFinished","showModal","hideModal","styles","mask","position","top","right","left","bottom","backgroundColor","height","zIndex","modalWrap","modal","fontSize","padding","width","margin","borderRadius","overflow","textAlign","isIE","window","ActiveXObject","isIE11","test","navigator","userAgent","dom","success","title","content","time","this","close","document","createElement","JSXdom","style","setTimeout","ReactDOM","render","body","appendChild","parentNode","removeChild","remove","createContext","userid","tplid","showLgin","Provider","Consumer","Cookies","require","updateStatus","message","report","getElementById","innerHTML","Str2Uint8","str","arraybuffer","ArrayBuffer","length","view","Uint8Array","i","l","charCodeAt","UploadDocContent","url","useType","user_id","action","wpsapp","wps","WpsApplication","docName","ActiveDocument","FullName","needbeDelte","FileSystem","Exists","docxml","WordOpenXML","newdoc","Documents","Add","TempPath","Env","GetTempPath","Mkdir","Range","InsertXML","SaveAs2","Close","fileName","console","log","fileData","FormData","blob","Blob","readAsBinaryString","type","file","File","append","xhr","XMLHttpRequest","onreadystatechange","readyState","status","responseText","alert","open","send","updateDirect","Remove","composeDocInsert","state","tplData","newName","slice","data","nums","parseInt","Math","random","RandomName","tpl_id","id","docIndex","get","undefined","optioninf","ownerid","curUser","doc_id","JSON","parse","options","handlePost","apiPublicPath","then","result","saveDocByte","responseType","ShowWriterPane","tsId","PluginStorage","getItem","tskpane","GetTaskPane","Visible","CreateTaskPane","Util","GetUrlPath","ID","setItem","ribbon","OnAddinLoad","ribbonUI","Enum","WPS_Enum","OnAction","control","Id","ShowComposerPane","GetImage","OnGetEnabled","OnGetVisible","eleId","OnGetLabel","OnNewDocumentApiEvent","doc","Name","md5","signInf","isValidInf","userInf","checkEmail","poneInput","uncompileStr","code","unescape","c","String","fromCharCode","WebAddinSignInOut","props","_dragOptions","moveMenuItemText","closeMenuItemText","hideEmail","logoutHandler","e","loginHandler","regLogin","signHandler","signShowHandler","signHideHandler","handleChangePhone","value","handleChangePsw","handleChangeCode","handleCodeKeypress","key","handleEmailKeypress","handleChangeEmail","checkInf","encryptedValues","replace","hex","isModelLoading","DialogAlert","newPros","newState","isModalVisible","Dialog","hidden","onDismiss","dialogContentProps","DialogType","normal","closeButtonAriaLabel","modalProps","isBlocking","main","maxWidth","dragOptions","TextField","label","onChange","required","className","display","fieldGroup","cursor","onClick","src","DialogFooter","Link","href","RootPath","ActionButton","iconProps","iconName","allowDisabledFocus","PrimaryButton","text","DefaultButton","React","mapDispatch","connect","current","modalVisible","initializeIcons","loadingComponent","error","align","marginTop","marginBotton","retry","timedOut","pastDelay","TaskHome","Loadable","loader","loading","delay","timeout","WebAddinDemoVideo","WebAddinWriter","WebAddinAboutUs","WebAddinCompose","fillFinanceTable","WebAddinTemplate","WebAddinTplDetail","WebAddinGenTpl","WebAddinWriterFillTable","WebAddinWriterRepository","WebAddinWriterMergeDocs","WebAddinWriterExpand","App","selectData","setState","SelectID","exp","Date","setTime","getTime","Days","set","useData","exact","path","component","to","Component","handleActions","combineActions","userAction","next","payload","isLoading","combineReducers","register","userObj","loginObj","handleFetch","logoutObj","checkloginHandler","signupHandler","userSaga","call","usersSource","msg","put","takeLatest","sagaMiddleware","createSagaMiddleware","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","appReducer","applyMiddleware","run","module","exports","publicPath","apiWritePath","a","defaultOptions","method","credentials","fetch","res","json","jsonStr","headers","stringify","response","reader","FileReader","onload","indexOf","writeAsBinaryString","Open","Selection","InsertFile","msoCTPDockPositionLeft","msoCTPDockPositionRight","location","toString","decodeURI","substring","lastIndexOf"],"mappings":"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","file":"static/js/main.b7817326.chunk.js","sourcesContent":["import { createActions } from 'redux-actions';\r\n import { identity } from 'ramda';\r\n//https://www.jianshu.com/p/d2615a7d725e\r\nexport const {\r\n  user: {\r\n    login,\r\n    signup,\r\n    logout,\r\n    checklogin,\r\n    checkloginFinished,\r\n    loginFinished,\r\n    signupFinished,\r\n    logoutFinished,\r\n    showModal,\r\n    hideModal\r\n   },\r\n} = createActions({\r\n  USER: {\r\n    LOGIN: ({\r\n      tel, email, password, remeber, captcha,\r\n    }) => ({\r\n      tel,\r\n      email,\r\n      password,\r\n      remeber,\r\n      captcha,\r\n    }),\r\n    SIGNUP: ({\r\n      tel, email, password, username, captcha,owner,sharer\r\n    }) => ({\r\n      tel,\r\n      email,\r\n      password,\r\n      username,\r\n      captcha,\r\n      owner,\r\n      sharer\r\n    }),\r\n    LOGOUT:() => {},\r\n    CHECKLOGIN:() => {},\r\n    CHECKLOGIN_FINISHED:null,\r\n    LOGIN_FINISHED:null,\r\n    SIGNUP_FINISHED:null,\r\n    LOGOUT_FINISHED:null,\r\n    SHOW_MODAL:null,\r\n    HIDE_MODAL:null\r\n  },\r\n});\r\n","/* eslint-disable no-lone-blocks */\nimport React from \"react\";\n//import { PrimaryButton, DefaultButton, ActionButton } from \"office-ui-fabric-react/lib/Button\";\nimport ReactDOM from \"react-dom\";\n//import { Stack } from \"office-ui-fabric-react/lib/Stack\";\n\nconst styles = {\n  mask: {\n    position: \"fixed\",\n    top: 0,\n    right: 0,\n    left: 0,\n    bottom: 0,\n    backgroundColor: \"rgba(0, 0, 0, 0.65)\",\n    height: \"100%\",\n    zIndex: 1000\n  },\n  modalWrap: {\n    position: \"fixed\",\n    top: 0,\n    right: 0,\n    left: 0,\n    bottom: 0,\n    zIndex: 1000\n  },\n  modal: {\n    fontSize: 14,\n    padding: 10,\n    width: 220,\n    height: 90,\n    margin: \"10px auto 0\",\n    backgroundColor: \"#fff\",\n    borderRadius: 4,\n    overflow: \"hidden\",\n    textAlign: \"center\"\n  }\n};\nfunction isIE() {\n  if (!!window.ActiveXObject || \"ActiveXObject\" in window) {\n    return true;\n  } else {\n    return false;\n  }\n}\nfunction isIE11() {\n  if (/Trident\\/7\\./.test(navigator.userAgent)) {\n    return true;\n  } else {\n    return false;\n  }\n}\nexport default {\n  dom: null, //被append的元素\n  success({ title, content, time }) {\n    if (isIE() || isIE11()) {\n    } else {\n      this.close();\n    }\n    this.dom = document.createElement(\"div\");\n    // JSX代码\n    const JSXdom = (\n      <div>\n        <div style={styles.mask} />\n        <div style={styles.modalWrap}>\n          <div style={styles.modal}>\n            <h3>{title}</h3>\n            <p>{content}</p>\n          </div>\n        </div>\n      </div>\n    );\n    {\n      setTimeout(() => {\n        this.close();\n      }, time);\n    }\n    ReactDOM.render(JSXdom, this.dom);\n    document.body.appendChild(this.dom);\n  },\n\n  close() {\n   //console.log(\"this.dom:\", this.dom);\n    if (isIE() || isIE11()) {\n      !!this.dom && this.dom.parentNode.removeChild(this.dom);\n    } else {\n      !!this.dom && this.dom.remove();\n    }\n  }\n};\n","//https://www.jianshu.com/p/da6181ca5564\n//https://www.jianshu.com/p/eba2b76b290b\n//https://www.jianshu.com/p/87632fc165d0\n//http://www.zzvips.com/article/191684.html\n//没有异步逻辑用 context，有异步逻辑用 redux\n//https://www.redux.org.cn/docs/react-redux/\n//https://segmentfault.com/a/1190000015684895\nimport {createContext} from \"react\";\n\nexport const {Provider, Consumer} = createContext({\n  userid: \"\",\n  tplid: \"\",\n  showLgin:false,\n});\n","/* global wps:false */\n//import axios from \"axios\";\nimport { apiPublicPath } from \"../../../settings\";\nimport { handlePost, saveDocByte } from \"../../WebAddinCommon\";\n//const iconv = require('iconv-lite')\nconst Cookies = require(\"js-cookie\");\nexport function arrayBufferToBase64(buffer) {\n  let binary = \"\";\n  let bytes = new Uint8Array(buffer);\n  let len = bytes.byteLength;\n  for (let i = 0; i < len; i++) {\n    binary += String.fromCharCode(bytes[i]);\n  }\n  return window.btoa(binary);\n}\nexport function updateStatus(message) {\n  let report = document.getElementById(\"status\");\n  //console.log(\"updateStatus_report\",report);\n  //console.log(\"updateStatus_message\",message);\n  if (report !== null) {\n    report.innerHTML = message;\n  }\n}\n\n// function checkName(inputvalue) {\n//   let str = inputvalue.toString();\n//   let checked = \"\";\n//   let spStr = \"￥#$~!@%^&*();'\\\"?><[]{}\\\\|,:/=+—'\";\n//   for (let i = 0; i < str.length; i++)\n//     if (spStr.indexOf(str.charAt(i)) !== -1) {\n//     } else {\n//       checked = checked + str.substr(i, 1);\n//     }\n//   return checked;\n// }\n// function sendSlice(slice, state, url, action, fileName) {\n//   let data = slice.data;\n//   // If the slice contains data, create an HTTP request.\n//   if (data) {\n//     // Encode the slice data, a byte array, as a Base64 string.\n//     // NOTE: The implementation of myEncodeBase64(input) function isn't\n//     // included with this example. For information about Base64 encoding with\n//     // JavaScript, see https://developer.mozilla.org/docs/Web/JavaScript/Base64_encoding_and_decoding.\n//     //var fileData = myEncodeBase64(data);\n//     let base64Str = arrayBufferToBase64(data);\n//     let fileData = new FormData();\n//     fileData.append(\"docCnt\", base64Str);\n//     fileData.append(\"file_ext\", \".docx\");\n//     //formData = JSON.stringify({ \"docCnt\": base64Str });\n//     // Create a new HTTP request. You need to send the request\n//     // to a webpage that can receive a post.\n//     let xhr = new XMLHttpRequest();\n//     // Create a handler function to update the status\n//     // when the request has been sent.\n//     xhr.onreadystatechange = function () {\n//       if (xhr.readyState === 4) {\n//         if (xhr.status === 200) {\n//           //updateStatus(\"发送了 \" + slice.size + \" 个字节\");\n//           action(xhr, fileName);\n//         } else {\n//           updateStatus(\"上传失败,检查上传地址是否正确\" + xhr.responseText);\n//         }\n//       }\n//     };\n\n//     xhr.open(\"POST\", url, true);\n//     //console.log(\"doc_id\", state.doc_id);\n//     fileData.append(\"doc_id\", state.doc_id);\n//     xhr.send(fileData);\n//   }\n// }\nfunction Str2Uint8(str){\n  //假设字符串”abc“ length=3,使用16位，则每一个字母占据2字节，总字节为length乘以2\n  var arraybuffer =new ArrayBuffer(str.length);\n  var view = new Uint8Array(arraybuffer);\n  for(var i=0,l=str.length;i<l;i++){\n      view[i] = str.charCodeAt(i);\n  }\n  return view;\n}   \nfunction updateDirect(url, useType, action, user_id, fileName) {\n  console.log(\"updateDirect_fileName:\", fileName);\n  if (fileName === \"\") {\n    fileName = \"未命名.docx\";\n  }\n  console.log(\"updateDirect_start_fileName:\", fileName);\n  //wps.alert(fileName);\n  try {\n    //使用axios上传文件\n\n    //  let formdata = new FormData();\n    //  formdata.append(\"file\", fileName) ;\n    //  formdata.append(\"user_id\", user_id) ;\n    //   wps.alert(formdata);\n    //  axios({\n    //      url:url,\n    //      method: 'post',\n    //      headers:{'Content-Type':'multipart/form-data'},\n    //      data:formdata\n    //  }).then(\n    //      request =>{\n    //          wps.alert(\"成功了：\" ,request.data);\n    //          console.log(request.data)\n    //      },\n    //      error =>{\n    //          wps.alert(\"失败了\" ,error.data);\n    //      }\n    //  )\n      \n    if (!wps.FileSystem.Exists(fileName)) {\n      wps.alert(\"没有找到文件：\", fileName);\n    } else {\n      //formData = JSON.stringify({ \"docCnt\": base64Str });\n      // Create a new HTTP request. You need to send the request\n      // to a webpage that can receive a post.\n      let fileData = new FormData();\n      // var blob = new Blob([wps.FileSystem.readAsBinaryString(fileName)], {\n      //   type: 'application/octet-stream'\n      //   });\n      var blob = new Blob([Str2Uint8(wps.FileSystem.readAsBinaryString(fileName))], {\n        type: 'application/octet-stream'\n        });\n     let file = new window.File([blob], \"lite.docx\", {type: blob.type})\n      //wps.alert(\"blob.size\"+file.size);\n      \n      fileData.append(\"file\", file);\n      fileData.append(\"user_id\", user_id);\n      //console.log(fileData);\n      let xhr = new XMLHttpRequest();\n      // Create a handler function to update the status\n      // when the request has been sent.\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState === 4) {\n          if (xhr.status === 200) {\n          if (xhr.responseText.length>35){\n            wps.alert(\"上传出错了：\"+xhr.responseText);\n          }else{\n            action(xhr, fileName);\n          }\n            //如果xhr.responseText中有false，那么不处理\n          } else {\n            updateStatus(\"上传失败,检查上传地址是否正确\" + xhr.responseText);\n          }\n        }\n      };\n      //wps.alert(\"上传文件：\", fileData);\n      xhr.open(\"POST\", url,true);\n      \n      xhr.send(fileData);\n    }\n  } catch {\n    // console.log(\"Error: \" + JSON.stringify(error));\n  }\n}\n\nexport function UploadDocContent(url, useType, user_id, action) {\n  let wpsapp = wps.WpsApplication();\n  let docName = wpsapp.ActiveDocument.FullName;\n  let needbeDelte=false; \n  if (!wps.FileSystem.Exists(docName)) {\n    let docxml = wpsapp.ActiveDocument.WordOpenXML;\n    let newdoc = wpsapp.Documents.Add(null, null, 0, false);\n    \n    let TempPath =wps.Env.GetTempPath()+ \"\\\\TempDoc\";  // wpsapp.NormalTemplate.Path;\n    if (!wps.FileSystem.Exists(TempPath)){\n      wps.FileSystem.Mkdir(TempPath);\n    }\n    docName = TempPath + \"\\\\TempDoc.docx\"; //linux下分隔符可能有问题\n    newdoc.Range(0, 0).InsertXML(docxml);\n    needbeDelte=true;\n    newdoc.SaveAs2(docName,12,null,null,false);\n    newdoc.Close(false);\n  }\n  try {\n    updateDirect(url, useType, action, user_id, docName);\n    if (needbeDelte===true){\n      try {\n        wps.FileSystem.Remove(docName);\n      } catch {}\n    }\n  } catch {}\n}\n\nfunction RandomName(length) {\n  const data =\n    [\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F\",\n      \"G\", \"H\", \"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\", \"Q\", \"R\", \"S\", \"T\", \"U\", \"V\", \"W\", \"X\", \"Y\",\n      \"Z\", \"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\", \"h\", \"i\", \"j\", \"k\", \"l\", \"m\", \"n\", \"o\", \"p\", \"q\", \"r\",\n      \"s\", \"t\", \"u\", \"v\", \"w\", \"x\", \"y\", \"z\"];\n  let nums = \"\";\n  for (let i = 0; i < length; i++) {\n    const r = parseInt(Math.random() * 61, 10);\n    nums += data[r];\n  }\n  return nums;\n}\nexport function composeDocInsert(state, tplData, xhr, fileName) {\n  //启动排版，并下载打开！cores/Composeext/${fileId}/${tempId}/${composeOpt}/${comptype}`);\n  console.log(\"composeInsert_fileName\", fileName);\n  const newName = fileName.slice(0, fileName.length - 5) +RandomName(12)+ \".aidocx.docx\";\n  console.log(\"composeInsert_newName\", newName);\n  let tpl_id = tplData.id;\n  //let actiontype = this.state.mainInf.searchType;\n  let docIndex = Cookies.get(\"ComposeGetType\");\n  console.log(\"schema_direct_docIndex:\", docIndex);\n  if (docIndex === undefined) {\n    docIndex = 1;\n  }\n  if (docIndex < 1) {\n    docIndex = 1;\n  }\n\n  let optioninf = Cookies.get(\"ComposeSet\");\n  if (optioninf === undefined) {\n    optioninf = \"111111116\";\n  }\n  console.log(\"schema_direct_optioninf：\", optioninf);\n  // console.log(\"ckserial：\", NewData.ckserial.join(\"\"));\n  if (tplData !== undefined) {\n    if (tplData.ownerid !== undefined) {\n      if (tplData.ownerid === \"0\") {\n      } else {\n        tpl_id = `${tplData.ownerid}_${tplData.id}`;\n      }\n    }\n  }\n  const user_id = state.curUser.user_id;\n    let data = {};\n    data.action = \"1\";\n    data.doc_id = JSON.parse(xhr.responseText).id;\n    data.tpl_id = tpl_id;\n    data.options = optioninf;\n    handlePost(`${apiPublicPath}cores/Composeext`, data).then(result => {\n      if (result.success === true) {\n        //插入结果！\n        console.log(\"composeInsert_finished_extend_data_插入结果:\", data);\n        //调用offcie webapi\n        updateStatus(\"排版完成，正在下载\");\n        console.log(\"InsertSource_path:\", result.doc_id);\n        let fileData = new FormData();\n        fileData.append(\"numName\", 1);\n        fileData.append(\"ownerid\", user_id);\n        fileData.append(\"tpl_id\", tpl_id);\n        fileData.append(\"index\", docIndex);\n        fileData.append(\"doc_id\", result.doc_id);\n        // var id = \"Base64DocxFile.txt\";\n        let url = `${apiPublicPath}tools/downresult/downInsert`;\n        let xhr = new XMLHttpRequest();\n        // xmlHttp.withCredentials = true;\n        xhr.onreadystatechange = function () {\n          if (xhr.readyState === 4 && xhr.status === 200) {\n            updateStatus(\"下载完成\");\n            saveDocByte(newName, xhr,1);\n          } else {\n            if (  xhr.status !== 200) {\n            updateStatus(\"正在下载中\")}}\n        };\n        xhr.open(\"POST\", url, true); //同步方式请求\n        xhr.responseType = \"arraybuffer\";\n        xhr.send(fileData);\n      }\n      //this.setState({});\n    },\n    () => {}\n  );\n}\n","import Util from '../js/util.js'\n//import SystemDemo from '../js/systemdemo.js'\n/* global wps:false */\n//var WebNotifycount = 0;\nfunction ShowComposerPane(wps){\n    let tsId = wps.PluginStorage.getItem(\"composer_id\")\n    if (!tsId) {\n        let tskpane = wps.CreateTaskPane(Util.GetUrlPath())\n        let id = tskpane.ID\n        console.log(\"ShowComposerPane\",Util.GetUrlPath() )\n        console.log(\"ShowComposerPane\",tskpane)\n        wps.PluginStorage.setItem(\"composer_id\", id)\n        tskpane.Visible = true\n    } else {\n        let tskpane = wps.GetTaskPane(tsId)\n        tskpane.Visible = !tskpane.Visible\n    }\n}\nfunction ShowWriterPane(wps){\n    let tsId = wps.PluginStorage.getItem(\"writer_id\")\n    if (!tsId) {\n        let tskpane = wps.CreateTaskPane(Util.GetUrlPath() + \"Writer\")\n        let id = tskpane.ID\n        console.log(\"ShowWriterPane\",tskpane)\n        console.log(\"ShowWriterPane\",Util.GetUrlPath()+ \"Writer\")\n        wps.PluginStorage.setItem(\"writer_id\", id)\n        tskpane.Visible = true\n    } else {\n        let tskpane = wps.GetTaskPane(tsId)\n        tskpane.Visible = !tskpane.Visible\n    }\n}\nvar ribbon = {\n    //这个函数在整个wps加载项中是第一个执行的\n    OnAddinLoad: function(ribbonUI) {\n       \n        if (typeof (wps.ribbonUI) !== \"object\") {\n            wps.ribbonUI = ribbonUI\n        }\n        if (typeof (wps.Enum) !== \"object\") { // 如果没有内置枚举值\n            wps.Enum = Util.WPS_Enum\n        }\n        //这几个导出函数是给外部业务系统调用的\n       /* \n        window.openOfficeFileFromSystemDemo = SystemDemo.openOfficeFileFromSystemDemo\n        window.InvokeFromSystemDemo = SystemDemo.InvokeFromSystemDemo\n        wps.PluginStorage.setItem(\"EnableFlag\", false) //往PluginStorage中设置一个标记，用于控制两个按钮的置灰\n        wps.PluginStorage.setItem(\"ApiEventFlag\", false) //往PluginStorage中设置一个标记，用于控制ApiEvent的按钮label\n        let bFlag = wps.PluginStorage.getItem(\"EnableFlag\")\n        wps.PluginStorage.setItem(\"EnableFlag\", !bFlag)\n        wps.ribbonUI.InvalidateControl(\"btnIsEnbable\")\n        wps.ribbonUI.InvalidateControl(\"btnShowDialog\")\n        wps.ribbonUI.InvalidateControl(\"btnShowWriter\")\n        wps.ribbonUI.InvalidateControl(\"btnShowComposer\")\n        */\n        ShowWriterPane(wps)\n        return true\n    },\n\n    OnAction: function(control) {\n        const eleId = control.Id\n        switch (eleId) {\n/*\n            case \"btnShowMsg\":\n                {\n                    const doc = wps.WpsApplication().ActiveDocument\n                    if (!doc) {\n                        alert(\"当前没有打开任何文档\")\n                        return\n                    }\n                    alert(doc.Name)\n                }\n                break;\n            case \"btnIsEnbable\":\n                {\n                    let bFlag = wps.PluginStorage.getItem(\"EnableFlag\")\n                    wps.PluginStorage.setItem(\"EnableFlag\", !bFlag)\n\n                    //通知wps刷新以下几个按饰的状态\n                    wps.ribbonUI.InvalidateControl(\"btnIsEnbable\")\n                    wps.ribbonUI.InvalidateControl(\"btnShowDialog\")\n                    wps.ribbonUI.InvalidateControl(\"btnShowTaskPane\")\n                    //wps.ribbonUI.Invalidate(); 这行代码打开则是刷新所有的按钮状态\n                    break\n                }\n            case \"btnShowDialog\":\n                wps.ShowDialog(Util.GetUrlPath() + \"dialog\", \"这是一个对话框网页\", 400 * window.devicePixelRatio, 400 * window.devicePixelRatio, false)\n                break\n*/\n            case \"btnShowComposer\":\n                ShowComposerPane(wps)\n                break\n            case \"btnShowWriter\":\n                ShowWriterPane(wps)\n                 break\n/*\n            case \"btnApiEvent\":\n                {\n                    let bFlag = wps.PluginStorage.getItem(\"ApiEventFlag\")\n                    let bRegister = bFlag ? false : true\n                    wps.PluginStorage.setItem(\"ApiEventFlag\", bRegister)\n                    if (bRegister){\n                        wps.ApiEvent.AddApiEventListener('DocumentNew', 'ribbon.OnNewDocumentApiEvent')\n                    }\n                    else{\n                        wps.ApiEvent.RemoveApiEventListener('DocumentNew', 'ribbon.OnNewDocumentApiEvent')\n                    }\n                    \n                    wps.ribbonUI.InvalidateControl(\"btnApiEvent\") \n                }\n                break\n            case \"btnWebNotify\":\n                {\n                    let currentTime = new Date()\n                    let timeStr = currentTime.getHours() + ':' + currentTime.getMinutes() + \":\" + currentTime.getSeconds()\n                    wps.OAAssist.WebNotify(\"这行内容由wps加载项主动送达给业务系统，可以任意自定义, 比如时间值:\" + timeStr + \"，次数：\" + (++WebNotifycount), true)\n                }\n                break\n*/\n            default:\n                break\n        }\n        return true\n    },\n\n    GetImage: function (control) {\n        const eleId = control.Id\n        switch (eleId) {\n            case \"btnShowMsg\":\n                return \"images/1.svg\"\n            case \"btnShowDialog\":\n                return \"images/2.svg\"\n            case \"btnShowTaskPane\":\n                return \"images/3.svg\"\n            case \"btnShowWriter\":\n                return \"images/2.svg\"\n            case \"btnShowComposer\":\n                return \"images/3.svg\"\n            default:\n        }\n        return \"images/newFromTemp.svg\"\n    },\n\n    OnGetEnabled: function (control) {\n        const eleId = control.Id\n        switch (eleId) {\n            case \"btnShowMsg\":\n                return true\n            case \"btnShowDialog\":\n                {\n                    let bFlag = wps.PluginStorage.getItem(\"EnableFlag\")\n                    return bFlag\n                }\n            case \"btnShowTaskPane\":\n                {\n                    let bFlag = wps.PluginStorage.getItem(\"EnableFlag\")\n                    return bFlag\n                }\n            default:\n                break\n        }\n        return true\n    },\n\n    OnGetVisible: function (control) {\n        const eleId = control.Id\n        console.log(eleId)\n        return true\n    },\n\n    OnGetLabel: function (control) {\n        const eleId = control.Id\n        switch (eleId) {\n            case \"btnIsEnbable\":\n                {\n                    let bFlag = wps.PluginStorage.getItem(\"EnableFlag\")\n                    return bFlag ? \"按钮Disable\" : \"按钮Enable\"\n                }\n            case \"btnApiEvent\":\n                {\n                    let bFlag = wps.PluginStorage.getItem(\"ApiEventFlag\")\n                    return bFlag ? \"清除新建文件事件\" : \"注册新建文件事件\"\n                }    \n            default:\n                break;\n        }\n        return \"\"\n    },\n\n    OnNewDocumentApiEvent:function(doc){\n        alert(\"新建文件事件响应，取文件名: \" + doc.Name)\n    }\n\n}\n\nexport default ribbon;","/* eslint-disable jsx-a11y/alt-text */\n//浮动窗口\nimport * as React from \"react\";\nimport { Dialog, DialogType, DialogFooter } from \"office-ui-fabric-react\";\nimport { PrimaryButton, DefaultButton, ActionButton } from \"office-ui-fabric-react\";\n//import { ContextualMenu } from \"office-ui-fabric-react/lib/ContextualMenu\";\n//import { Label } from 'office-ui-fabric-react/lib/Label';\nimport { TextField } from \"office-ui-fabric-react\";\n//import { getId } from 'office-ui-fabric-react/lib/Utilities';\nimport { apiPublicPath, RootPath } from \"../../settings\";\n//import { Consumer } from \"../WebAddinContext\";\nimport { connect } from \"react-redux\";\n//import { Stack } from \"office-ui-fabric-react/lib/Stack\";\nimport { Link } from \"office-ui-fabric-react\";\nimport DialogAlert from \"../WebAddinCommon/DynamicModal\";\nimport { login, logout, signup, showModal, hideModal } from \"../../actions\";\nconst Cookies = require(\"js-cookie\"); //登录过就不要再注册了\nconst md5 = require(\"js-md5\");\nlet signInf = [];\nfunction isPoneAvailable(poneInput) {\n  if (!/^1[3456789]\\d{9}$/.test(poneInput)) {\n    return false;\n  } else {\n    return true;\n  }\n}\nfunction isEmail(str) {\n  var re = /^([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+\\.[a-zA-Z]{2,3}$/;\n  if (re.test(str) !== true) {\n    return false;\n  } else {\n    return true;\n  }\n}\n/*\nfunction isValidReg(chars) {\n  var re = /<|>|\\[|\\]|\\{|\\}|『|』|※|○|●|◎|§|△|▲|☆|★|◇|◆|□|▼|㊣|﹋|⊕|⊙|〒|ㄅ|ㄆ|ㄇ|ㄈ|ㄉ|ㄊ|ㄋ|ㄌ|ㄍ|ㄎ|ㄏ|ㄐ|ㄑ|ㄒ|ㄓ|ㄔ|ㄕ|ㄖ|ㄗ|ㄘ|ㄙ|ㄚ|ㄛ|ㄜ|ㄝ|ㄞ|ㄟ|ㄢ|ㄣ|ㄤ|ㄥ|ㄦ|ㄧ|ㄨ|ㄩ|■|▄|▆|\\*|@|#|\\^|\\\\/;\n  if (re.test(chars) === true) {\n    return false;\n  } else {\n    return true;\n  }\n}\n */\n//对字符串进行加密\n \nfunction isValidInf(userInf, checkEmail) {\n  //console.log(\"(userInf  \", userInf);\n  //console.log(\"(userInf ).length\", (userInf[\"code\"] + \"\").length);\n  if ((userInf[\"code\"] + \"\").length < 4) {\n    return \"验证码错误\";\n  }\n  if (checkEmail === true) {\n    console.log(\"userInf[email]:\", userInf[\"email\"]);\n    if (isEmail(userInf[\"email\"]) === false) {\n      return \"邮箱格式不合法\";\n    }\n  }\n  if (isPoneAvailable(userInf[\"phone\"]) === false) {\n    return \"手机格式不合法\";\n  }\n  if ((userInf[\"psw\"] + \"\").length < 6) {\n    return \"密码长度不够或者不合法\";\n  }\n  return true;\n}\n//字符串进行解密\nfunction uncompileStr(code) {\n  code = unescape(code);\n  var c = String.fromCharCode(code.charCodeAt(0) - code.length);\n  for (var i = 1; i < code.length; i++) {\n    c += String.fromCharCode(code.charCodeAt(i) - c.charCodeAt(i - 1));\n  }\n  return c;\n}\n \n\nclass WebAddinSignInOut extends React.Component {\n  constructor(props) {\n    super(props);\n    signInf[\"phone\"] = uncompileStr(Cookies.get(\"phone\"));\n    signInf[\"psw\"] =  uncompileStr(Cookies.get(\"pswen\"));\n    signInf[\"email\"] = uncompileStr(Cookies.get(\"email\"));\n    signInf[\"code\"] =\"\";\n  }\n  _dragOptions = {\n    moveMenuItemText: \"移动\",\n    closeMenuItemText: \"关闭\",\n    //menu: ContextualMenu\n  };\n  state = {\n    hideEmail: false,\n  };\n  \n  componentDidUpdate(newPros, newState) {\n    console.log(\"trigger:componentDidUpdate\");\n    //console.log(\"app_componentDidUpdate\", this.props.curUser);\n\n  }\n  componentDidMount(){\n    //读cookie登陆,发现没有登录时才启动\n    //console.log(\"app_componentDidMount\", this.props.curUser);\n        /*\n      if (this.props.isLoginIn === true) {\n        this.setState({ curUser: this.props.curUser, isModalVisible: true, hideEmail: true });\n        // this.props.getCookie(res);\n      } else {\n        this.setState({ curUser: { user_id: \"\" } ,SelectID:\"\"});\n      } ;\n      */\n  }\n  \nlogoutHandler = (e) => {\n  this.props.logout({});\n  /*\n  handlePost(`${apiPublicPath}users/reglogin/logout`, {}).then((result) => {\n    // this.props.history.push(\"/\");\n    this.setState({ curUser: { user_id: \"\" }, isModalVisible: false, hideEmail: true });\n    //console.log(\"logout_ok:\",this.state)\n  });\n  */\n};\n\nloginHandler = (userInf, e) => {\n  this.regLogin(userInf, false);\n};\nsignHandler = (userInf, e) => {\n  this.regLogin(userInf, true);\n};\nsignShowHandler = (e) => {\n  //this.setState({ isModalVisible: false });\n  this.props.showModal();\n};\nsignHideHandler = (e) => {\n // this.setState({ isModalVisible: true });\n  this.props.hideModal();\n};\n\n  handleChangePhone = (e, value) => {\n    //console.log(\"sign_up_change_e:\",e);\n    //console.log(\"sign_up_change_value:\",value);\n    signInf[\"phone\"] = value;\n    //console.log(\"this.state:\",this.state)\n  };\n\n  handleChangePsw = (e, value) => {\n    //console.log(\"sign_up_change_e:\",e);\n    //console.log(\"sign_up_change_value:\",value);\n    signInf[\"psw\"] = value;\n  };\n\n  handleChangeCode = (e, value) => {\n    signInf[\"code\"] = value;\n  };\n  handleCodeKeypress = (e ) => {\n      \n    console.log(\"handleCodeKeypress_handleCodeKeypress_e:\",e);\n    if (e!=undefined && e.key === \"Enter\") {\n     \n    }\n  };\n  handleEmailKeypress = (e ) => {\n    \n     console.log(\"EmailKeypress_handleCodeKeypress_e:\",e);\n    if (e!=undefined && e.key === \"Enter\") {\n \n    }\n  };\n\n  handleChangeEmail = (e, value) => {\n    signInf[\"email\"] = value;\n  };\n\nregLogin = (userInf, checkEmail) => {\n  const checkInf = isValidInf(userInf, checkEmail);\n  if (isValidInf(userInf, checkEmail) === true) {\n    let encryptedValues = {};\n    encryptedValues = {\n      tel: userInf[\"phone\"].replace(/\\s+/g, \"\"),\n      password: md5.hex(userInf[\"psw\"] + md5.hex(userInf[\"psw\"])),\n      captcha: userInf[\"code\"].replace(/\\s+/g, \"\"),\n      email: userInf[\"email\"].replace(/\\s+/g, \"\"),\n    };\n    if (this.state.isModelLoading) {\n      return;\n    }\n    if (checkEmail === true) {\n      //注册\n      this.props.signup(encryptedValues);\n\n      /*\n      const loginRes = `${apiPublicPath}users/reglogin/register`;\n      //console.log(\" JSON.stringify(encryptedValues):\",  JSON.stringify(encryptedValues));\n      handlePost(loginRes, encryptedValues).then((result) => {\n        try {\n          if (result.success === true) {\n            this.setState({ curUser: result, isModalVisible: true, hideEmail: true });\n            console.log(\"checkEmail === true,this.state.curUser:\", this.state.curUser);\n            //写入本地cookie\n            Cookies.set(\"phone\", compileStr(telphone), { expires: 365 });\n            Cookies.set(\"email\", compileStr(email), { expires: 365 });\n            Cookies.set(\"pswen\", compileStr(userInf[\"psw\"]), { expires: 365 });\n          } else {\n            DialogAlert.success({\n              title: \"注册错误\",\n              content: result.msg,\n              time: 2000,\n            });\n            document.getElementById(\"captchain\").src = `${apiPublicPath}tools/codepic?` + Math.random();\n          }\n        } catch (e) {\n          DialogAlert.success({\n            title: \"注册错误\",\n            content: \"数据获取错误，请检查网络！\",\n            time: 2000,\n          });\n        }\n      });\n    */\n    } else {\n      //登录{\"tel\": \"13886186111\", \"password\": \"338cedb8182d67647893fea981e3ffac\", \"deviceid\": \"husteducntestjames\"}\n      this.props.login(encryptedValues);\n\n      /*\n      const loginRes = `${apiPublicPath}users/reglogin/login`;\n      //console.log(\" JSON.stringify(encryptedValues):\",  JSON.stringify(encryptedValues));\n      handlePost(loginRes, encryptedValues).then((result) => {\n        try {\n          if (result.success === true) {\n            this.setState({ curUser: result, isModalVisible: true, hideEmail: true });\n             console.log(\"checkEmail === false,this.state.curUser:\", this.state.curUser);\n            //写入本地cookie\n            Cookies.set(\"phone\", compileStr(telphone), { expires: 365 });\n            Cookies.set(\"email\", compileStr(email), { expires: 365 });\n            Cookies.set(\"pswen\", compileStr(userInf[\"psw\"]), { expires: 365 });\n          } else {\n            DialogAlert.success({\n              title: \"登录错误\",\n              content: result.msg,\n              time: 2000,\n            });\n            document.getElementById(\"captchain\").src = `${apiPublicPath}tools/codepic?` + Math.random();\n          }\n        } catch (e) {\n          //console.log(e);\n          // message.error(\"数据获取错误，请检查网络！\");\n          DialogAlert.success({\n            title: \"登录错误\",\n            content: \"数据获取错误，请检查网络！\",\n            time: 2000,\n          });\n        }\n      });\n      */\n    }\n//判断是否应该隐藏\nconsole.log(\"webaddinSigninout_onclick\",this.props.user_id)\n\n  } else {\n    //显示提示信息\n    //alert(checkInf);\n    //console.log(\"userInf:\", userInf);\n    DialogAlert.success({\n      title: \"输入错误\",\n      content: checkInf,\n      time: 2000,\n    });\n  }\n};\n//onKeyPress={this.handleEmailKeypress(   )}\n// onKeyPress={this.handleEmailKeypress(  )}\n\n  render() {\n    console.log(\"websinginout_this.props.isModalVisible:\",this.props.isModalVisible);\n    return (\n          <Dialog\n            hidden={!this.props.isModalVisible}\n            onDismiss={this.props.hideModal}\n            dialogContentProps={{\n              type: DialogType.normal,\n              closeButtonAriaLabel: \"关闭\",\n              title: \"注册登录\",\n            }}\n            modalProps={{\n              isBlocking: false,\n              styles: { main: { maxWidth: 450 } },\n              dragOptions: this._dragOptions,\n            }}\n          >\n            <TextField\n              label=\"手机号\"\n              onChange={this.handleChangePhone}\n             \n              required\n            />\n\n            <TextField\n              label=\"密码\"\n              type=\"password\"\n              onChange={this.handleChangePsw}\n             \n              required\n            />\n            <div className=\"piccode\">\n              <div style={{ display: \"flex\", width: \"90px\" }}>\n                <TextField\n                  label=\"验证码\"\n                  styles={{ fieldGroup: { width: 100 } }}\n                  onChange={this.handleChangeCode}\n                  \n                  required\n                />\n              </div>\n\n              <img\n                style={{ cursor: \"pointer\" }}\n               // className={styles[\"changeinImg\"]}\n                onClick={() =>\n                  (document.getElementById(\"captchain\").src = `${apiPublicPath}tools/codepic?` + Math.random())\n                }\n                id=\"captchain\"\n                className=\"captchain\"\n                src={`${apiPublicPath}tools/codepic`}\n              />\n            </div>\n\n            <div hidden={!!this.state.hideEmail}>\n              <TextField\n                label=\"Email\"\n                onChange={this.handleChangeEmail}\n              />\n            </div>\n            <DialogFooter>\n              <Link href={RootPath + \"FindPsw\"}>\n                <ActionButton iconProps={{ iconName: \"ProtectRestrict\" }} allowDisabledFocus></ActionButton>\n              </Link>\n              <PrimaryButton onClick={()=>this.regLogin(signInf,false)} text=\"登录\" />\n              <DefaultButton onClick={()=>this.regLogin(signInf,true )} text=\"注册\" />\n            </DialogFooter>\n          </Dialog>\n        )}\n}\n\nconst mapState = state => {\n \n  return {\n    curUser: state.current,\n    user_id:  state.current.user_id ,\n    isModalVisible: state.modalVisible\n  };\n};\nconst mapDispatch = {\n    signup,\n    login,\n    logout,\n    showModal,\n    hideModal\n};\n\nexport default connect(\n  mapState,\n  mapDispatch\n)(WebAddinSignInOut);","/* eslint-disable no-useless-escape */\nimport React from 'react';\nimport ribbon from './ribbon';\nimport \"./App.scss\";\nimport { connect } from \"react-redux\";\nimport Loadable from \"react-loadable\";\nimport { Provider } from \"./WebAddinContext\";\nimport WebAddinSignInOut from \"./WebAddinSignInOut\";\n//import Relogin from \"./WebAddinReglogin\";\nimport DialogAlert from \"./WebAddinCommon/DynamicModal\";\nimport { HashRouter as Router, Redirect, Route, Switch } from \"react-router-dom\";\n//import { Dialog, DialogType, DialogFooter } from \"office-ui-fabric-react/lib/Dialog\";\nimport { apiPublicPath } from \"../settings\";\nimport { handlePost, handleFetch } from \"./WebAddinCommon\";\nimport { initializeIcons } from \"office-ui-fabric-react/lib/Icons\";\nimport { checklogin  } from \"../actions\";\nconst md5 = require(\"js-md5\");\nconst Cookies = require(\"js-cookie\");\ninitializeIcons(); \n/*\n              <Route path=\"/OtherFun\" component={WebAddinOtherFun} />\n              <Route path=\"/UserCenter/:id\" component={WebAddinUserCenter} />\n              <Route path=\"/UserCenter\" component={WebAddinUserCenter} />\n              <Route path=\"/Helper/:id\" component={WebAddinHelper} />\n              <Route path=\"/Helper\" component={WebAddinHelper} />\n              <Route path=\"/DemoVideo\" component={WebAddinDemoVideo} />\n              <Route path=\"/AboutUs\" component={WebAddinAboutUs} />\n              <Route path=\"/Reglogin\" component={WebAddinReglogin} />\n              <Route path=\"/FindPsw\" component={WebAddinFindPsw} />\n*/\nconst loadingComponent = (props) => {\n  if (props.error) {\n    return (\n      <div align=\"center\" marginTop=\"50px\" marginBotton=\"50px\">\n        <h2>\n          对不起，加载遇到错误，请刷新界面！<button onClick={props.retry}>刷新</button>\n        </h2>\n      </div>\n    );\n  } else if (props.timedOut) {\n    return (\n      <div align=\"center\" marginTop=\"50px\" marginBotton=\"50px\">\n        <h2>\n          对不起，加载超时，请刷新界面！ <button onClick={props.retry}>重试</button>\n        </h2>\n      </div>\n    );\n  } else if (props.pastDelay) {\n    return <p />;\n  } else {\n    return <p />;\n  }\n};\n\nconst TaskHome = Loadable({\n  loader: () => import(\"./WebAddinTaskPane\"),\n  loading: loadingComponent,\n  delay: 1500,\n  timeout: 10000,\n});\nconst WebAddinDemoVideo = Loadable({\n  loader: () => import(\"./WebAddinDemoVideo\"),\n  loading: loadingComponent,\n  delay: 1500,\n  timeout: 10000,\n});\nconst WebAddinWriter = Loadable({\n  loader: () => import(\"./WebAddinWriter\"),\n  loading: loadingComponent,\n  delay: 1500,\n  timeout: 10000,\n});\nconst WebAddinAboutUs = Loadable({\n  loader: () => import(\"./WebAddinAboutUs\"),\n  loading: loadingComponent,\n  delay: 1500,\n  timeout: 10000,\n});\nconst WebAddinCompose = Loadable({\n  loader: () => import(\"./WebAddinCompose\"),\n  loading: loadingComponent,\n  delay: 1500,\n  timeout: 10000,\n});\n\nexport const fillFinanceTable = Loadable({\n  loader: () => import(\"./WebAddinWriter/WriteComponents/pages/fillFinanceTable\"),\n  loading: loadingComponent,\n  delay: 1500,\n  timeout: 10000,\n});\n\n\nexport const WebAddinTemplate = Loadable({\n  loader: () => import(\"./WebAddinCompose/WebAddinTemplate\"),\n  loading: loadingComponent,\n  delay: 1500,\n  timeout: 10000,\n});\n\nexport const WebAddinTplDetail = Loadable({\n  loader: () => import(\"./WebAddinCompose/WebAddinTplDetail\"),\n  loading: loadingComponent,\n  delay: 1500,\n  timeout: 10000,\n});\nexport const WebAddinGenTpl = Loadable({\n  loader: () => import(\"./WebAddinCompose/WebAddinGenTpl\"),\n  loading: loadingComponent,\n  delay: 1500,\n  timeout: 10000,\n});\n \nexport const WebAddinWriterFillTable = Loadable({\n  loader: () => import(\"./WebAddinWriter/WriteComponents/pages/fillTable\"),\n  loading: loadingComponent,\n  delay: 1500,\n  timeout: 10000,\n});\n\nexport const WebAddinWriterRepository = Loadable({\n  loader: () => import(\"./WebAddinWriter/WriteComponents/pages/Repository\"),\n  loading: loadingComponent,\n  delay: 1500,\n  timeout: 10000,\n});\n\nexport const WebAddinWriterMergeDocs = Loadable({\n  loader: () => import(\"./WebAddinWriter/WriteComponents/pages/merge\"),\n  loading: loadingComponent,\n  delay: 1500,\n  timeout: 10000,\n});\n\nexport const WebAddinWriterExpand = Loadable({\n  loader: () => import(\"./WebAddinWriter/WriteComponents/pages/expand\"),\n  loading: loadingComponent,\n  delay: 1500,\n  timeout: 10000,\n});\n\n/*\nconst WebAddinOtherFun = Loadable({\n    loader: () => import(\"./WebAddinOtherFun\"),\n    loading: loadingComponent,\n    delay: 1500,\n    timeout: 10000\n});\n\nconst WebAddinUserCenter = Loadable({\n    loader: () => import(\"./WebAddinUserCenter\"),\n    loading: loadingComponent,\n    delay: 1500,\n    timeout: 10000\n});\n\nconst WebAddinReglogin = Loadable({\n    loader: () => import(\"./WebAddinReglogin\"),\n    loading: loadingComponent,\n    delay: 1500,\n    timeout: 10000\n});\n\nconst WebAddinFindPsw = Loadable({\n    loader: () => import(\"./WebAddinFindPsw\"),\n    loading: loadingComponent,\n    delay: 1500,\n    timeout: 10000\n});\n\nconst MoblieResetPsw = Loadable({\n    loader: () => import(\"./WebAddinResetPsw\"),\n    loading: loadingComponent,\n    delay: 1500,\n    timeout: 10000\n});\n*/\n\n\n// function Str2Uint16(str){\n//   //假设字符串”abc“ length=3,使用16位，则每一个字母占据2字节，总字节为length乘以2\n//   var arraybuffer =new ArrayBuffer(str.length*2);\n//   var view = new Uint16Array(arraybuffer);\n//   for(var i=0,l=str.length;i<l;i++){\n//       view[i] = str.charCodeAt(i);\n//   }\n//   return view;\n// }   \n\n// function Str2Uint8(str){\n//   //假设字符串”abc“ length=3,使用16位，则每一个字母占据2字节，总字节为length乘以2\n//   var arraybuffer =new ArrayBuffer(str.length);\n//   var view = new Uint8Array(arraybuffer);\n//   for(var i=0,l=str.length;i<l;i++){\n//       view[i] = str.charCodeAt(i);\n//   }\n//   return view;\n// }    \n \n// export function readwrite() {\n\n//     let data = wps.FileSystem.readAsBinaryString(\"d:\\\\1.docx\")\n//     //let file = new window.File([blob], \"no_fileName\", {type: blob.type})\n// //     var link = document.createElement(\"a\"); // Or maybe get it from the current document\n// // link.href = blob;\n// // link.download = \"aDefaultFileName.docx\";\n// // link.innerHTML = \"Click here to download the file\";\n// // document.body.appendChild(link); // Or append it whereever you wan\n//    let buffer = Buffer.from(data);\n//    console.log(\"data.length:\",data.length);\n//    console.log(\"buffer:\",buffer.buffer);\n//    var blob = new Blob([Str2Uint8(data)], {\n//     type: 'application/octet-stream'\n//     });\n//     let file = new window.File([blob], \"lite.docx\", {type: blob.type})\n//     //wps.alert(\"blob.size\"+file.size);\n//     console.log(\"file:\",file); \n//     console.log(\"msSaveOrOpenBlob:\",navigator); \n//     //wps.FileSystem.writeAsBinaryString(\"d:\\\\2.docx\",data)\n//   let newName= \"d:\\\\2.docx\"\n\n//   var reader = new FileReader();\n//   reader.readAsBinaryString(blob);\n//   reader.onload = function(){\n//       //读取完毕后输出结果\n//      // console.log(this.result);\n//       wps.FileSystem.writeAsBinaryString(newName,this.result);\n//       console.log(\"this.result\");\n//   }\n  \n//   if (navigator.msSaveOrOpenBlob) {\n    \n//     navigator.msSaveOrOpenBlob(blob, newName);\n    \n//   } else {\n//     let temp_link = document.createElement('a');\n//     let evt = document.createEvent(\"HTMLEvents\");\n//     evt.initEvent(\"click\", true, true); //initEvent 不加后两个参数在FF下会报错  事件类型，是否冒泡，是否阻止浏览器的默认行为\n//     temp_link.href = URL.createObjectURL(blob);\n//     temp_link.download = newName;\n//     temp_link.type = \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\";\n//     document.body.appendChild(temp_link);\n//     temp_link.click();\n//     temp_link.remove();\n//   }\n\n// }\nexport function arrayBufferToBase64(buffer) {\n  let binary = \"\";\n  let bytes = new Uint8Array(buffer);\n  let len = bytes.byteLength;\n  for (let i = 0; i < len; i++) {\n    binary += String.fromCharCode(bytes[i]);\n  }\n  return window.btoa(binary);\n}\n\n \nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n    // readwrite();\n    console.log(\"init ribbon\");\n    window.ribbon = ribbon;\n  }\n  \n  componentDidUpdate(newPros, newState) {\n    //console.log(\"trigger:componentDidUpdate\");\n   // console.log(\"app_componentDidUpdate\", this.props.curUser);\n\n\n  }\n  componentDidMount() {\n    if (this.props.user_id===undefined){\n      console.log(\"app_componentDidMount\")\n      this.props.checklogin();\n    }\n\n    //读cookie登陆,发现没有登录时才启动\n    //自动登录，要写入到action中\n    /*\n    handleFetch(`${apiPublicPath}users/reglogin/index`, { method: \"GET\" }).then((res) => {\n      if (res !==undefined && res.success === true) {\n        this.setState({ curUser: res, hideSignDlg: true, hideEmail: true });\n        // this.props.getCookie(res);\n      } else {\n        this.setState({ curUser: { user_id: \"\" } });\n      }\n    });\n       \n\n      if (this.props.isLoginIn === true) {\n        this.setState({ curUser: this.props.curUser, isModalVisible: true, hideEmail: true });\n         \n      } else {\n        this.setState({ curUser:\"\" ,SelectID:\"\"});\n      } ;\n\n      console.log(\"app_componentDidMount_this.props.curUser\", this.props.curUser);\n      console.log(\"app_componentDidMount_state\", this.state);\n      */\n     \n  }\n    \n  selectData = (e) => {\n    this.setState({ SelectID: e });\n    console.log(\"selectData_e\", e);\n    console.log(\"app_componentDidMount_this.props.curUser\", this.props.curUser);\n    console.log(\"app_componentDidMount_state\", this.state);\n    var Days = 30;\n    var exp = new Date();\n    exp.setTime(exp.getTime() + Days*24*60*60*1000);\n    Cookies.set(\"FinanceYear\",e);\n  };\n  useData = (e) => {\n    console.log(\"app_componentDidMount_this.props.curUser\", this.props.curUser);\n    console.log(\"app_componentDidMount_state\", this.state);\n    console.log(\"read cookie\",Cookies.get(\"FinanceYear\"))\n  };\n  render() {\n    //如果在浏览器打开网页，那么会显示下面内容\n    //之前的结构就不修改了\n    return (\n      \n      <div className=\"App\">\n        <Provider\n          value={{\n            state: this.state,\n            selectData: this.selectData,\n            useData:this.useData\n          }}\n        >\n          <Router>\n            <Switch>\n              <Route exact path=\"/\" component={TaskHome} />\n              <Route path=\"/DemoVideo\" component={WebAddinDemoVideo} />\n              <Route path=\"/AboutUs\" component={WebAddinAboutUs} />\n              <Route path=\"/Compose\" component={WebAddinCompose} />\n              <Route path=\"/Writer\" component={WebAddinWriter} />\n              <Route render={() => <Redirect to=\"/\" />} />\n            </Switch>\n          </Router>\n          <WebAddinSignInOut />\n         \n          </Provider>\n      </div>\n    );\n  }\n}\n \n\nconst mapState = state => {\n \n  return {\n    curUser: state.current,\n    user_id:  state.current.user_id ,\n    isModalVisible: state.modalVisible\n  };\n};\nconst mapDispatch = {\n  checklogin,\n};\n\nexport default connect(\n  mapState,\n  mapDispatch\n)(App);\n ","import { combineReducers } from \"redux\";\nimport { handleActions, combineActions } from \"redux-actions\";\nimport * as userAction from \"../actions\";\n  \nexport const current = handleActions(\n  {\n    [combineActions(userAction.loginFinished, userAction.signupFinished, userAction.checkloginFinished, userAction.logout)]: {\n      next(state, action) {\n        return action.payload;\n      }\n    }\n  },\n  {}\n);\n //暂时没有用到\nexport const isLoading = handleActions(\n  {\n    [combineActions(userAction.login,userAction.signup)]() {\n      return true;\n    },\n    [combineActions(userAction.loginFinished, userAction.signupFinished)]() {\n      return false;\n    }\n  },\n  false\n);\n\nexport const modalVisible = handleActions(\n  {\n    [userAction.showModal]() {\n      return true;\n    },\n    [userAction.loginFinished]() {\n      return false;\n    },\n    [userAction.signupFinished]() {\n      return false;\n    },\n    [userAction.hideModal]() {\n      return false;\n    }\n  },\n  false\n);\n \nexport default combineReducers({\n  current,\n  isLoading,\n  modalVisible,\n});\n","import {handlePost,handleFetch} from '../components/WebAddinCommon';\nimport {apiPublicPath} from '../settings';\n \nexport function register(userObj) {\n    return handlePost(`${apiPublicPath}users/reglogin/register`,  userObj );\n}\n \nexport function login(loginObj) {\n    return handlePost(`${apiPublicPath}users/reglogin/login`,  loginObj );\n}\n\nexport function checklogin(loginObj) {\n    return handleFetch(`${apiPublicPath}users/reglogin/index`,  loginObj );\n}\n \nexport function logout(logoutObj) {\n    return handlePost(`${apiPublicPath}users/reglogin/logout`,  logoutObj );\n}\n\nexport async function getComposeRecordList(user_id) {\n\n    return handlePost(`${apiPublicPath}getinfs/getcomposelist/index`,  user_id );\n}\n\nexport async function getCreditRecordList(user_id) {\n\n  return handlePost(`${apiPublicPath}getinfs/getscorelist/index`,  user_id );\n}\n \nexport async function editProfile(newUserObj) {\n\n    return handlePost(`${apiPublicPath}users/upuserinf/index`, newUserObj );\n}","import {call, put, takeLatest} from 'redux-saga/effects';\nimport { message } from 'antd'\nimport * as usersSource from '../sources/users';\nimport {\n    login,\n    loginFinished,\n    logout,\n    logoutFinished,\n    signup,\n    signupFinished,\n    checklogin,\n    checkloginFinished,\n} from '../actions';\n \nimport { apiPublicPath } from \"../settings\";\n \nexport function* loginHandler({ payload }) {\n  try {\n    const result = yield call(usersSource.login, payload);\n    const action = yield call(loginFinished, result);\n    if (result === undefined) {\n      //message.error(\"与服务器通讯异常！\");\n    }else {\n      if (result.success === true) {\n        //message.success(result.msg);\n      } else {\n        message.error(result.msg);\n        document.getElementById(\"captchain\").src = `${apiPublicPath}tools/codepic?` + Math.random();\n      }\n    }\n    yield put(action);\n  } catch (e) {\n   // console.log(e);\n    yield put(loginFinished(e));\n  }\n}\n\nexport function* checkloginHandler({ payload }) {\n  try {\n    const result = yield call(usersSource.checklogin, payload);\n    const action = yield call(checkloginFinished, result);\n    if (result === undefined) {\n      //message.error(\"与服务器通讯异常！\");\n    }else {\n      if (result.success === true) {\n        //message.success(result.msg);\n      } \n    }\n    yield put(action);\n  } catch (e) {\n   // console.log(e);\n    yield put(loginFinished(e));\n  }\n}\n\nfunction* logoutHandler({ payload }) {\n  try {\n    const result = yield call(usersSource.logout, payload);\n    const action = yield call(logoutFinished, result);\n    yield put(action);\n  } catch (e) {\n    // console.log(e);\n    yield put(logoutFinished(e));\n  }\n}\n\nfunction* signupHandler({ payload }) {\n  try {\n    const result = yield call(usersSource.register, payload);\n    // console.log(\"注册结果：\",result);\n    const action = yield call(signupFinished, result);\n    if (result === undefined) {\n     // message.error(\"与服务器通讯异常！\");\n    }else{\n      if(result.success===true){\n        //message.success(result.msg);\n      }else{\n        message.error(result.msg);\n        //mobile:\n        document.getElementById(\"captchain\").src = `${apiPublicPath}tools/codepic?` + Math.random();\n      }\n    }\n    yield put(action);\n  } catch (e) {\n   // console.log(e);\n    yield put(signupFinished(e));\n  }\n}\n \nexport default function* userSaga() {\n  yield takeLatest(login, loginHandler);\n  yield takeLatest(checklogin, checkloginHandler);\n  yield takeLatest(signup, signupHandler);\n  yield takeLatest(logout, logoutHandler);\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport createSagaMiddleware from 'redux-saga';\n//import { HashRouter, Route, Switch } from 'react-router-dom';\nimport App from './components/App';\n// import Dialog from './components/dialog';\n// import TaskPane from './components/taskpane';\nimport { Provider } from 'react-redux';\nimport { createStore, compose, applyMiddleware} from 'redux';\nimport { AppContainer } from \"react-hot-loader\"; \nimport appReducer from './reducers';\nimport userSaga from './sagas';\n/*\n关于全局管理参考文献:\nhttp://www.zzvips.com/article/191684.html\nhttps://www.jianshu.com/p/e84493c7af35\nhttps://www.jianshu.com/p/b17d8bec13f3\nredux参考：https://www.jianshu.com/p/21960f78937d\n导航条参考：https://developer.microsoft.com/en-us/fabric-js/components/commandbar/commandbar\n*/\nconst title = \"筷子文档\"//\"Intelligent Composing\";\n\nconst sagaMiddleware = createSagaMiddleware();\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\nconst store = createStore(appReducer,{},composeEnhancers(applyMiddleware(sagaMiddleware)));\nsagaMiddleware.run(userSaga);\nReactDOM.render(\n<Provider store={store}>\n  <AppContainer>\n    <App title={title}  />\n  </AppContainer>\n </Provider>,\ndocument.getElementById(\"root\")\n);","module.exports = {\n  publicPath: '/',\n  apiPublicPath: '/api/',\n  apiWritePath: '/vstoapi/',\n  RootPath: 'https://www.aidocx.com/',\n};\n","/* eslint-disable no-unused-vars */\n//import {apiPublicPath} from \"../../settings\";\n/* global wps:false */\nimport {updateStatus} from \"./UploadDocContent\";\n\nexport async function handleFetch(url, options = {}) {\n  const defaultOptions = {\n    method: \"GET\",\n    credentials: \"same-origin\"\n  };\n  /*\n  if (path([\"method\"], options) === \"POST\") {\n    defaultOptions.headers = {\n      \"Content-Type\": \"application/json\"\n    };\n  }\n  */\n\nconsole.log(\"handleFetch_url：\", url);\n  //const resultOptions = mergeDeepRight(defaultOptions, options);\n  try {\n    const res = await fetch(url, defaultOptions);\n    //checkStatus(res);\n    if (typeof res !== \"string\") {\n      if (res !==undefined && typeof res === \"object\" && res) {\n        let result=\"\";\n        try {\n            result= res.json(); //错误在这里,如果出错，那么会保持result属性\n         }catch (e) {\n            //message.error(\"数据请求错误，请检查网络！\");\n         }\n     \n        if ((typeof result)!==\"object\"){\n          return {\"success\":false};\n        }else{\n          return result;\n        }\n      }\n    } else {\n     // message.error(\"返回数据格式错误，网站可能在维护！\");\n    }\n  } catch (e) {\n   // message.error(\"数据请求错误，请检查网络！\");\n  }\n}\n//    credentials: \"same-origin\",\nexport  async function handlePost(url, jsonStr) {\n //console.log(\" _typeof_jsonStr:\", typeof jsonStr);\n //console.log(\"_json:\", jsonStr);\n  const defaultOptions = {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(jsonStr)\n  };\n  console.log(\"handlePost_url：\", url);\n  //const resultOptions = mergeDeepRight(defaultOptions, options);\n  try {\n     const res =  await fetch(url, defaultOptions);\n     //console.log(\"handlePost_res：\", res);\n     if (typeof res !== \"string\") {\n      if (res !==undefined &&  typeof res === \"object\" && res ) {\n        return res.json();\n      }\n    } else {\n      \n     //console.log(\"返回数据格式错误，网站可能在维护！\");\n     // message.error(\"返回数据格式错误，网站可能在维护！\");\n    }\n  } catch (e) {\n    //message.error(\"数据请求错误，请检查网络！\");\n   //console.log(\"数据请求错误，请检查网络！\");\n  }\n}\n\nexport function saveDocByte(newName,xhr,action) {\n//wps支持写入本地文件，是否也支持呢\n  let blob = new Blob([xhr.response]);\n  var reader = new FileReader();\n  reader.readAsBinaryString(blob);\n  reader.onload = function(){\n      //读取完毕后输出结果\n     // console.log(this.result);\n    if (newName.indexOf(\"\\\\\")===-1  && newName.indexOf(\"/\")===-1){\n      let TempPath =wps.Env.GetTempPath()+ \"\\\\TempSource\";  // wpsapp.NormalTemplate.Path;\n      if (!wps.FileSystem.Exists(TempPath)){\n        wps.FileSystem.Mkdir(TempPath);\n      }\n        newName=TempPath+\"/\"+newName;\n    }\n      wps.FileSystem.writeAsBinaryString(newName,this.result);\n      if (action===1){\n        //直接打开文档\n        if (wps.FileSystem.Exists(newName)){\n          wps.WpsApplication().Documents.Open(newName);\n          }else{\n            updateStatus(\"下载失败！\");\n          }\n      }\n      if (action===2){\n        //直接插入文档\n        if (wps.FileSystem.Exists(newName)){\n          let wpsapp = wps.WpsApplication();\n          wpsapp.Selection.Range.InsertFile(newName);\n          wps.FileSystem.Remove(newName);\n        }\n      }      \n  }\n  // if (navigator.msSaveOrOpenBlob) {\n  //   navigator.msSaveOrOpenBlob(blob, newName);\n  // } else {\n  //   let temp_link = document.createElement('a');\n  //   let evt = document.createEvent(\"HTMLEvents\");\n  //   evt.initEvent(\"click\", true, true); //initEvent 不加后两个参数在FF下会报错  事件类型，是否冒泡，是否阻止浏览器的默认行为\n  //   temp_link.href = URL.createObjectURL(blob);\n  //   temp_link.download = newName;\n  //   temp_link.type = \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\";\n  //   document.body.appendChild(temp_link);\n  //   temp_link.click();\n  //   temp_link.remove();\n  // }\n}\n/*\nexport async function handleDataFetch(url, options) {\n  const defaultOptions = { method: \"GET\", credentials: \"same-origin\" };\n\n  //缓存机制：https://www.cnblogs.com/jztan/p/8367384.html\n  //字节流图缓存：https://blog.csdn.net/programmeryu/article/details/77162186\n  //'Cache-control':'max-age=3600,must-revalidate',\n\n  defaultOptions.headers = { \"Content-Type\": \"application/json\" };\n  const resultOptions = mergeDeepRight(defaultOptions, options);\n  try {\n    const res = await fetch(url, resultOptions);\n    checkStatus(res);\n   // console.log(\"handleDataFetch_result\", res);\n    return res.json();\n  } catch (e) {\n    message.error(\"数据请求错误，请检查网络！\");\n  }\n}\n */\n\nexport function synGetFile(url) {\n  //console.log(url);\n  try {\n    var elemIF = document.createElement(\"iframe\");\n    elemIF.src = url;\n    elemIF.style.display = \"none\";\n    //elemIF.setAttribute(\"src\", 'data:text/plain,');\n    document.body.appendChild(elemIF);\n    // console.log('elemIF', elemIF);\n  } catch (e) {\n    // console.log(e);\n  }\n}\nexport function iframeNav(url) {\n  //console.log(url);\n  try {\n    var elemIF = document.createElement(\"iframe\");\n    elemIF.src = url;\n    elemIF.style.display = \"none\";\n    //elemIF.setAttribute(\"src\", 'data:text/plain,');\n    document.body.appendChild(elemIF);\n    elemIF.click();\n    // console.log('elemIF', elemIF);\n  } catch (e) {\n    // console.log(e);\n  }\n}\n","//在后续的wps版本中，wps的所有枚举值都会通过wps.Enum对象来自动支持，现阶段先人工定义\r\nvar WPS_Enum = {\r\n  msoCTPDockPositionLeft: 0,\r\n  msoCTPDockPositionRight: 2,\r\n};\r\n\r\nfunction GetUrlPath() {\r\n  let e = document.location.toString();\r\n  e = decodeURI(e);\r\n  if (-1 !== e.indexOf(\"/\")) e = e.substring(0, e.lastIndexOf(\"/\"));\r\n  return e;\r\n}\r\n \r\nexport default {\r\n  WPS_Enum,\r\n  GetUrlPath,\r\n};\r\n"],"sourceRoot":""}