(this.webpackJsonpaidocx=this.webpackJsonpaidocx||[]).push([[19],{305:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return c}));n(320);function a(e){return e.success?null==e.head?null==e.msg?"":e.msg:'{"head":'+e.head+',"data":'+e.msg+"}":""}function o(e){return e.success?null!=e.head?null==e.msg?"":e.msg:'{"head":'+e.head+',"data":'+e.msg+"}":""}function l(e){return e.success?null==e.head?null==e.msg?"":e.msg:'{"head":'+e.head+',"data":'+e.msg+"}":""}function s(e,t){var n={};if(-1!==e.indexOf(t)){var a=JSON.parse(e);for(var o in a){var l=o.substring(o.indexOf("_")+1);n.title=l.substring(0,l.lastIndexOf(":")),n.key=l.substring(l.lastIndexOf(":")+1);var r=[];for(var i in a[o]){var c={};if(""!==a[o][i]){var u='{"'+i+'":'+JSON.stringify(a[o][i])+"}";c=s(u,t),-1!==u.indexOf(t)&&r.push(c)}else if(-1!==i.indexOf(t)){var f=i.substring(i.indexOf("_")+1);c.title=f.substring(0,f.lastIndexOf(":")),c.key=f.substring(f.lastIndexOf(":")+1),r.push(c)}}r.length>0&&(n.children=r)}}return n}function r(e,t){var n=[];for(var a in e){var o=s(e[a]["\u6587\u672c\u5143\u7ed3\u6784"],t);"{}"!==JSON.stringify(o)&&n.push(o)}return console.log("TreeJson:",n),n}function i(e){var t=[];for(var n in e){console.log(n),console.log("JsonStr:",e[n]);var a={};a.title=e[n]["\u5e74\u4efd"],a.key=n,t.push(a)}return console.log("TreeJson:",t),t}function c(e){var t=[],n=[],a=[],o=0;for(var l in e)if("\u8d22\u62a5ID"==l||"\u516c\u53f8ID"==l);else{var s={},r={};s.title=l,s.key=o,r.key=o,r.value=e[""+l],t.push(s),n.push(r),o++}return a.push(t),a.push(n),console.log(a),a}},474:function(e,t,n){"use strict";(function(e){var a=n(98),o=n(99),l=n(101),s=n(100),r=n(0),i=n.n(r),c=n(308),u=n(480),f=(n(299),n(478),n(85)),d=n(47),g=n(305),h=n(29),p=n(144),b=[],v=function(e,t,n,a){console.log("selectedKeys, info",e,t),console.log("mather",n),console.log("baction",a)},m=function(t){Object(l.a)(r,t);var n=Object(s.a)(r);function r(t){var o;return Object(a.a)(this,r),(o=n.call(this,t)).onCheck=function(e,t,n){console.log("onCheck",n),console.log("test selectData:",t),void 0!==t&&t(n),console.log("test newstate:",e),b=n;var a=wps.PluginStorage.getItem("filltable_1");if(a){var o=wps.GetTaskPane(a);console.log("\u91cd\u65b0\u663e\u793a\u586b\u8868taskpane\uff1a"),console.log(o),o.Visible=!0,o.Width=500}else{console.log("\u65b0taskpane\uff1a",f.a.GetUrlPath().substring(0,f.a.GetUrlPath().lastIndexOf("/"))+"writer/fillFinanceTable");var l=wps.CreateTaskPane(f.a.GetUrlPath().substring(0,f.a.GetUrlPath().lastIndexOf("/"))+"writer/fillFinanceTable"),s=l.ID;wps.PluginStorage.setItem("filltable_1",s),l.Visible=!0,l.Width=500}},o.reloaddata=function(e,t){console.log("filltable state:",e),console.log("filltable this.state:",o.state);var n={"\u516c\u53f8ID":1};Object(d.b)("".concat(h.apiWritePath,"getinf/getAll/getAllFinances"),n).then((function(e){if(console.log("get-Repository-tree-result:",e),!0===e.success){console.log(e);var t=Object(g.f)(e);console.log("realdata",t);var n=Object(g.c)(t);o.setState({treeData:n})}}),(function(e){}))},o.insertdata=function(t,n){console.log("filltable state:",t);var a=function(){console.log("id:",o),(l={}).\u516c\u53f8ID=1,l.\u6587\u672c\u5143\u7f16\u53f7=o;var t=wps.WpsApplication();Object(d.b)("".concat(h.apiWritePath,"download/downloadTextRepositoryXml"),l).then((function(n){console.log("get-Repository-tree-result:",n),!0===n.success&&(console.log("result.msg:",e.from(n.msg,"base64").toString("utf-8")),t.ActiveDocument.Range(t.Selection.Start,t.Selection.End).InsertXML(e.from(n.msg,"base64").toString("utf-8")))}),(function(e){}))};for(var o in b){var l;a()}},o.state={treeData:o.reloaddata()},o}return Object(o.a)(r,[{key:"componentDidUpdate",value:function(){console.log("FillTable_componentDidUpdate_this.props.location:",this.props)}},{key:"UNSAFE_componentWillMount",value:function(){console.log("FillTable_this.props.location:",this.props)}},{key:"render",value:function(){var e=this;return i.a.createElement(p.a,null,(function(t){var n=t.state,a=t.selectData;return i.a.createElement("div",null,i.a.createElement("h2",null,"\u62a5\u8868\u81ea\u52a8\u586b\u5199 "),i.a.createElement(c.a,{onClick:e.insertdata.bind(e,n,a)},"\u63d2\u5165"),i.a.createElement(c.a,{onClick:e.reloaddata.bind(e,n,a)},"\u5237\u65b0"),i.a.createElement("br",null),i.a.createElement(u.a,{checkable:!0,onSelect:v,onCheck:e.onCheck.bind(e,n,a),treeData:e.state.treeData,multiple:"false"}))}))}}]),r}(i.a.Component);t.a=m}).call(this,n(371).Buffer)},478:function(e,t,n){"use strict"},508:function(e,t,n){"use strict";n.r(t);var a=n(98),o=n(99),l=n(101),s=n(100),r=n(0),i=n.n(r),c=n(474),u=function(e){Object(l.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(c.a,null))}}]),n}(r.Component);t.default=u}}]);
//# sourceMappingURL=19.cf50b271.chunk.js.map