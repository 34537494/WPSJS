{"version":3,"sources":["../node_modules/@ant-design/icons-svg/es/asn/TranslationOutlined.js","../node_modules/@ant-design/icons/es/icons/TranslationOutlined.js","components/WebAddinWriter/WriteComponents/replacePunctuation/handleSearch.js","components/WebAddinWriter/WriteComponents/pages/expand/iconEvent.js","components/WebAddinWriter/WriteComponents/replaceSearch/handleSearch.js","components/WebAddinWriter/WriteComponents/replaceSearch/index.js","components/WebAddinWriter/WriteComponents/pages/expand/index.js"],"names":["TranslationOutlined","props","ref","React","AntdIcon","_objectSpread","icon","TranslationOutlinedSvg","displayName","counts","getNewXml_punctuation","doc1","txt","newdocxml","split","length","i","push","slice","console","log","new_txt","txt_split","charCodeAt","String","fromCharCode","replace_punctuation","join","isodd","newxml","num","SingleWord","indexOf","handleSearch","value","wps","Application","ActiveDocument","Content","Text","Macro3","checked","check_val","toBold","toItalic","toUnderline","Selection","Find","Wrap","Execute","sel","Font","Bold","Italic","Underline","replace_punctuation_main","doc","doc_split","newPara","para_isodd","finalParaXml","FinalXml","wpsapp","WpsApplication","FullName","Select","Range","Delete","InsertXML","needbeDelte","err","handle","param","WordOpenXML","Handle","ShowDialog","window","devicePixelRatio","oldcaption","ActiveWindow","Caption","getNewXml","word","replaceWord","word_split","replaceWord_split","j","replace","replace_main","Search","Input","SearchInput","onSearch","state","isChecked","obj","document","getElementsByName","k","fun","Replace","Word","getElementById","bind","direction","placeholder","id","style","width","this","Component","expand","margin","padding","size","onClick","handleClick","QuestionOutlined"],"mappings":"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","file":"static/js/26.a75f5f15.chunk.js","sourcesContent":["// This icon file is generated automatically.\nvar TranslationOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"defs\", \"attrs\": {}, \"children\": [{ \"tag\": \"style\", \"attrs\": {} }] }, { \"tag\": \"path\", \"attrs\": { \"d\": \"M140 188h584v164h76V144c0-17.7-14.3-32-32-32H96c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h544v-76H140V188z\" } }, { \"tag\": \"path\", \"attrs\": { \"d\": \"M414.3 256h-60.6c-3.4 0-6.4 2.2-7.6 5.4L219 629.4c-.3.8-.4 1.7-.4 2.6 0 4.4 3.6 8 8 8h55.1c3.4 0 6.4-2.2 7.6-5.4L322 540h196.2L422 261.4a8.42 8.42 0 00-7.7-5.4zm12.4 228h-85.5L384 360.2 426.7 484zM936 528H800v-93c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v93H592c-13.3 0-24 10.7-24 24v176c0 13.3 10.7 24 24 24h136v152c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V752h136c13.3 0 24-10.7 24-24V552c0-13.3-10.7-24-24-24zM728 680h-88v-80h88v80zm160 0h-88v-80h88v80z\" } }] }, \"name\": \"translation\", \"theme\": \"outlined\" };\nexport default TranslationOutlined;\n","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport TranslationOutlinedSvg from \"@ant-design/icons-svg/es/asn/TranslationOutlined\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar TranslationOutlined = function TranslationOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: TranslationOutlinedSvg\n  }));\n};\n\nTranslationOutlined.displayName = 'TranslationOutlined';\nexport default /*#__PURE__*/React.forwardRef(TranslationOutlined);","/* global wps:false */\r\n\r\nfunction handleSearch(value) {\r\n    console.log(wps.Application.ActiveDocument.Content.Text);\r\n\r\n}\r\nlet counts = 0\r\nfunction Macro3(value, checked, check_val) {\r\n    if (checked === true) {\r\n        var toBold = check_val.indexOf(\"1\") > -1 ? true : false;\r\n        var toItalic = check_val.indexOf(\"2\") > -1 ? true : false;\r\n        var toUnderline = check_val.indexOf(\"3\") > -1 ? 1 : 0;\r\n        for (; 1 > 0;) {\r\n            wps.Application.Selection.Find.Wrap = 0;\r\n            console.log(wps.Application.ActiveDocument.Content.Text);\r\n            if (!wps.Application.Selection.Find.Execute(value)) {\r\n                console.log(\"no\");\r\n                break\r\n            }\r\n            let sel = wps.Application.Selection.Font;\r\n            // sel.Bold=\t9999998;     //切换属性\r\n            sel.Bold = toBold;\r\n            sel.Italic = toItalic;\r\n            sel.Underline = toUnderline;\r\n            console.log(++counts)\r\n        }\r\n    }\r\n    else {\r\n        console.log(wps.Application.ActiveDocument.Content.Text);\r\n        console.log(counts + 1)\r\n        wps.Application.Selection.Find.Execute(value)\r\n        wps.Application.Selection.Find.Wrap = 1;\r\n    }\r\n}\r\n\r\n//整个函数结构与替换文字相似，不过取消了原字与替换字的输入，只需要匹配xml文件即可\r\nfunction replace_punctuation_main(doc) {\r\n\r\n    var doc_split = doc.split(\"w:p>\")                                       //将xml文件以段落分组\r\n    var newPara = [];\r\n    var para_isodd = false                                                  //判断循环是否处于奇数\r\n    for (var i = 0; i < doc_split.length; i++) {\r\n        if (para_isodd && i !== doc_split.length - 1) {\r\n            newPara[i] = getNewXml_punctuation(doc_split[i])        //如果为含有文本的内容，则进入getNewXml函数，获取每段的新的xml存入一个数组中\r\n            para_isodd = false\r\n        }\r\n        else if (!para_isodd && i !== doc_split.length - 1) {\r\n\r\n            newPara[i] = doc_split[i] + \"w:p>\"                      //否则，直接添加进新段落数组中\r\n            para_isodd = true\r\n        }\r\n        else {\r\n            newPara[i] = doc_split[i]                               //若为最后一个，则为一些配置属性，直接添加\r\n        }\r\n    }\r\n\r\n    var finalParaXml = \"\"\r\n    for (i = 0; i < newPara.length; i++) {\r\n        finalParaXml += newPara[i]                              //将每段内容拼接起来得到段落部分的xml\r\n    }\r\n    var FinalXml = \"\"\r\n\r\n    FinalXml += finalParaXml       //将原始头部和尾部与段落部分拼接起来，得到最终xml\r\n\r\n    console.log(FinalXml)\r\n\r\n\r\n    //以下为写入文件部分\r\n    let wpsapp = wps.WpsApplication();\r\n    let docName = wpsapp.ActiveDocument.FullName;\r\n    let needbeDelte = false;\r\n    // if (!wps.FileSystem.Exists(docName)) {\r\n    //     let TempPath = wps.Env.GetTempPath() + \"\\\\TempDoc\";  // wpsapp.NormalTemplate.Path;\r\n    //     let TempPath_forall = TempPath.split(\"/\").join(\"\\\\\")\r\n    //     if (!wps.FileSystem.Exists(TempPath_forall)) {\r\n    //         wps.FileSystem.Mkdir(TempPath_forall);\r\n    //     }\r\n    //     // docName = TempPath + \"\\\\TempDoc.docx\"; //linux下分隔符可能有问题\r\n    //     let newdoc = wps.WpsApplication().Documents.Add(null, null, 0, false);\r\n    //     newdoc.Range(0, 0).InsertXML(FinalXml);\r\n    //     needbeDelte = true;\r\n    //     console.log(TempPath_forall + \"\\\\\" + docName)\r\n    //     newdoc.SaveAs2(TempPath_forall + \"\\\\\" + docName, 12, null, null, false);\r\n    //     newdoc.Close(false);\r\n    // }\r\n    // else{\r\n    //     wpsapp.ActiveDocument.Content.Select()\r\n    //     wpsapp.Selection.Range.Delete()\r\n    //     wpsapp.ActiveDocument.Range(0, 0).InsertXML(FinalXml);\r\n    // }\r\n        wpsapp.ActiveDocument.Content.Select()\r\n        wpsapp.Selection.Range.Delete()\r\n        wpsapp.ActiveDocument.Range(0, 0).InsertXML(FinalXml);\r\n    try {\r\n        if (needbeDelte === true) {\r\n            try {\r\n                wps.FileSystem.Remove(docName);\r\n            } catch(err) { }\r\n        }\r\n    } catch(err) { }\r\n}\r\n\r\n//第一个参数为按照段落拆分的xml文本\r\nfunction getNewXml_punctuation(doc1) {\r\n    var txt = [];              //存储Word文档中的文字\r\n    var newdocxml = [];           //存储每段中\r\n    if(doc1.split(/w:t>|w:t xml:space=\"preserve\">/).length === 1)                //如果没有文本内容，不做修改\r\n    {\r\n        return doc1 + \"w:p>\"\r\n    }\r\n    for (var i = 0; i < (doc1.split(/w:t>|w:t xml:space=\"preserve\">/).length - 1) / 2; i++) {\r\n        if (doc1.split(/w:t>|w:t xml:space=\"preserve\">/)[1 + 2 * i]) {\r\n            if (doc1.split(/w:t>|w:t xml:space=\"preserve\">/)[1 + 2 * i].length > 2) {\r\n                if (doc1) {\r\n                    newdocxml.push(doc1.slice(0, -2))                                                  //将拆分后的数组存储进newdocxml中\r\n                }\r\n                txt.push(doc1.split(/w:t>|w:t xml:space=\"preserve\">/)[1 + 2 * i].slice(0, -2))         //将文本提取出来，每一个部分为数组的一个值\r\n            }\r\n            else {\r\n                console.log(\"error\")\r\n            }\r\n        }\r\n    }\r\n\r\n    let new_txt = replace_punctuation(txt.join(\"\"))\r\n    var isodd = false\r\n    var newxml = \"\"\r\n    var num = 0\r\n    if(txt)\r\n    {\r\n        var SingleWord = new_txt\r\n    }\r\n\r\n    for (i = 0; i < doc1.split(/w:t>|w:t xml:space=\"preserve\">/).length; i++) {\r\n        \r\n        if (!isodd && i !== doc1.split(/w:t>|w:t xml:space=\"preserve\">/).length - 1) {\r\n            newxml += (doc1.split(/w:t>|w:t xml:space=\"preserve\">/)[i] + \"w:t>\")\r\n            isodd = true\r\n        }\r\n       \r\n        else if (isodd && i !== doc1.split(/w:t>|w:t xml:space=\"preserve\">/).length - 1) {\r\n            if(SingleWord.slice(num, num + txt[(i - 1) / 2].length).indexOf(\" \") === -1)\r\n            {\r\n                newxml += (SingleWord.slice(num, num + txt[(i - 1) / 2].length).join(\"\") + \"</w:t>\")\r\n            }\r\n            else if(SingleWord.slice(num, num + txt[(i - 1) / 2].length).indexOf(\" \") !== -1 && newxml.slice(-4) === \"w:t>\")\r\n            {\r\n                newxml = newxml.slice(0,newxml.length-5) + \"<w:t xml:space=\\\"preserve\\\">\" + (SingleWord.slice(num, num + txt[(i - 1) / 2].length).join(\"\") + \"</w:t>\")\r\n            }\r\n            else\r\n            {\r\n                newxml += (SingleWord.slice(num, num + txt[(i - 1) / 2].length).join(\"\") + \"</w:t>\")\r\n            }\r\n            num += txt[(i - 1) / 2].length\r\n            isodd = false\r\n        }\r\n        else {\r\n            newxml += \"</w:r></w:p>\"\r\n        }\r\n    }\r\n    // console.log(newxml)\r\n    return newxml;\r\n}\r\n\r\n//将文本内容传入即可\r\nfunction replace_punctuation(txt) {\r\n\r\n    //将文本中的字符按照Unicode编码匹配，如果需要处理则验证前后一个字符是否为对应内容\r\n    let txt_split = txt.split(\"\")\r\n\r\n    for(var i = 0;i<txt_split.length;i++)\r\n    {\r\n        if(i < txt.length-1)\r\n        {\r\n            if(txt.charCodeAt(i) === 12288){                              //全角空格并非与半角空格之间相差65248，需要特殊处理\r\n                if(((65 <= txt.charCodeAt(i-1) && txt.charCodeAt(i-1) <= 90) || (97 <= txt.charCodeAt(i-1) && txt.charCodeAt(i-1) <= 122)) && ( (65 <= txt.charCodeAt(i+1) && txt.charCodeAt(i+1) <= 90) || (97 <= txt.charCodeAt(i+1) && txt.charCodeAt(i+1) <= 122)))          //如果Unicode编码小于等于255就是英文字符，如果大于则为中文，前后均为英文则需要修改\r\n                {\r\n                    txt_split[i] = ' ';\r\n                }\r\n                else{\r\n                    continue\r\n                }\r\n            }\r\n            else if(txt.charCodeAt(i) === 12290){                              //中文句号要特殊处理\r\n                if(((65 <= txt.charCodeAt(i-1) && txt.charCodeAt(i-1) <= 90) || (97 <= txt.charCodeAt(i-1) && txt.charCodeAt(i-1) <= 122)) && ( (65 <= txt.charCodeAt(i+1) && txt.charCodeAt(i+1) <= 90) || (97 <= txt.charCodeAt(i+1) && txt.charCodeAt(i+1) <= 122)))          //如果Unicode编码小于等于255就是英文字符，如果大于则为中文，前后均为英文则需要修改\r\n                {\r\n                    txt_split[i] = '.';\r\n                }\r\n                else{\r\n                    continue\r\n                }\r\n            }\r\n            else if(txt.charCodeAt(i) === 32)                                //英文空格需要特殊处理\r\n            {   \r\n                if(txt.charCodeAt(i-1) >255 && txt.charCodeAt(i+1) >255)\r\n                {\r\n                    txt_split[i] = String.fromCharCode(12288)\r\n                }\r\n            }\r\n            else if(txt.charCodeAt(i) === 46)                                //英文句号需要特殊处理\r\n            {\r\n                if(txt.charCodeAt(i-1) >255 && txt.charCodeAt(i+1) >255)\r\n                {\r\n                    txt_split[i] = String.fromCharCode(12290)\r\n                }\r\n            }\r\n            else if(txt.charCodeAt(i) >= 65281 && txt.charCodeAt(i) <= 65374){             // 如果Unicode编码位于全角！（65281）到全角～（65374）区间内，则为中文标点\r\n                if(((65 <= txt.charCodeAt(i-1) && txt.charCodeAt(i-1) <= 90) || (97 <= txt.charCodeAt(i-1) && txt.charCodeAt(i-1) <= 122)) && ( (65 <= txt.charCodeAt(i+1) && txt.charCodeAt(i+1) <= 90) || (97 <= txt.charCodeAt(i+1) && txt.charCodeAt(i+1) <= 122)))          //如果Unicode编码小于等于255就是英文字符，如果大于则为中文，前后均为英文则需要修改\r\n                {\r\n                    // console.log(txt[i])\r\n                    // console.log(String.fromCharCode(txt.charCodeAt(i)-65248))\r\n                    txt_split[i] = String.fromCharCode(txt.charCodeAt(i)-65248)\r\n                }\r\n                else{\r\n                    continue\r\n                }\r\n            }\r\n            \r\n            else if(txt.charCodeAt(i) >= 33 && txt.charCodeAt(i) <= 126){\r\n                if(txt.charCodeAt(i-1) >255 && txt.charCodeAt(i+1) >255)\r\n                {\r\n                    txt_split[i] = String.fromCharCode(txt.charCodeAt(i)+65248)\r\n                }\r\n            }\r\n            \r\n        }\r\n        else{                   //末尾的字符\r\n            if(txt.charCodeAt(i) === 12288){                              //全角空格并非与半角空格之间相差65248，需要特殊处理\r\n                if((65 <= txt.charCodeAt(i-1) && txt.charCodeAt(i-1) <= 90) || (97 <= txt.charCodeAt(i-1) && txt.charCodeAt(i-1) <= 122))          //如果Unicode编码小于等于255就是英文字符，如果大于则为中文，前后均为英文则需要修改\r\n                {\r\n                    txt_split[i] = ' ';\r\n                }\r\n                else{\r\n                    continue\r\n                }\r\n            }\r\n            else if(txt.charCodeAt(i) === 12290){                              //中文句号要特殊处理\r\n                if((65 <= txt.charCodeAt(i-1) && txt.charCodeAt(i-1) <= 90) || (97 <= txt.charCodeAt(i-1) && txt.charCodeAt(i-1) <= 122))          //如果Unicode编码小于等于255就是英文字符，如果大于则为中文，前后均为英文则需要修改\r\n                {\r\n                    txt_split[i] = '.';\r\n                }\r\n                else{\r\n                    continue\r\n                }\r\n            }\r\n            else if(txt.charCodeAt(i) === 32)\r\n            {\r\n                if(txt.charCodeAt(i-1) >255)\r\n                {\r\n                    txt_split[i] = String.fromCharCode(12288)\r\n                }\r\n            }\r\n            else if(txt.charCodeAt(i) === 46)\r\n            {\r\n                if(txt.charCodeAt(i-1) >255)\r\n                {\r\n                    txt_split[i] = String.fromCharCode(12290)\r\n                }\r\n            }\r\n            else if(txt.charCodeAt(i) >= 65281 && txt.charCodeAt(i) <= 65374){             // 如果Unicode编码位于全角！（65281）到全角～（65374）区间内，则为中文标点\r\n                if((65 <= txt.charCodeAt(i-1) && txt.charCodeAt(i-1) <= 90) || (97 <= txt.charCodeAt(i-1) && txt.charCodeAt(i-1) <= 122))          //如果Unicode编码小于等于255就是英文字符，如果大于则为中文，前后均为英文则需要修改\r\n                {\r\n                    txt_split[i] = String.fromCharCode(txt.charCodeAt(i)-65248)\r\n                }\r\n                else{\r\n                    continue\r\n                }\r\n            }\r\n            else if(txt.charCodeAt(i) >= 33 && txt.charCodeAt(i) <= 126){\r\n                if(txt.charCodeAt(i-1) >255){\r\n                    txt_split[i] = String.fromCharCode(txt.charCodeAt(i)+65248)\r\n                }\r\n            }\r\n            else{\r\n                continue\r\n            }\r\n        }\r\n    }\r\n    return txt_split;\r\n}\r\n\r\n\r\nexport default { handleSearch, Macro3, replace_punctuation_main };","/* global wps:false */\r\n \r\nimport Handle from '../../replacePunctuation/handleSearch';\r\n\r\n\r\nfunction handle(param) {\r\n \r\n    switch (param) {\r\n\r\n        case \"中英文标点匹配\":\r\n            {\r\n                var doc = wps.WpsApplication().ActiveDocument.WordOpenXML\r\n                Handle.replace_punctuation_main(doc)\r\n                break;\r\n            }\r\n\r\n        case \"帮助2\":\r\n            {\r\n                console.log(param);\r\n                wps.ShowDialog(\"http://localhost:3889/help2.html\", \"帮助\", 500 * window.devicePixelRatio, 300 * window.devicePixelRatio, false);\r\n                break;\r\n            }\r\n           \r\n        default:\r\n            break;\r\n    }\r\n    //console.log(wps.Application.ActiveWindow.Caption);\r\n    let oldcaption=  wps.Application.ActiveDocument.ActiveWindow.Caption ;\r\n    wps.Application.ActiveDocument.ActiveWindow.Caption =  oldcaption+\" \";\r\n    wps.Application.ActiveDocument.ActiveWindow.Caption =  oldcaption ;\r\n//    wps.Application.ActiveDocument.ActiveWindow.View.Zoom.Percentage = wps.Application.ActiveDocument.ActiveWindow.View.Zoom.Percentage+1;\r\n//    wps.Application.ActiveDocument.ActiveWindow.View.Zoom.Percentage = wps.Application.ActiveDocument.ActiveWindow.View.Zoom.Percentage-1;\r\n    // wps.Application.ActiveWindow.ScrollIntoView(wps.Application.Selection.Range, true)\r\n  \r\n}\r\nexport default handle;","/* global wps:false */\r\n\r\nfunction handleSearch(value) {\r\n    console.log(wps.Application.ActiveDocument.Content.Text);\r\n\r\n}\r\nlet counts = 0\r\nfunction Macro3(value, checked, check_val) {\r\n    if (checked === true) {\r\n        var toBold = check_val.indexOf(\"1\") > -1 ? true : false;\r\n        var toItalic = check_val.indexOf(\"2\") > -1 ? true : false;\r\n        var toUnderline = check_val.indexOf(\"3\") > -1 ? 1 : 0;\r\n        for (; 1 > 0;) {\r\n            wps.Application.Selection.Find.Wrap = 0;\r\n            console.log(wps.Application.ActiveDocument.Content.Text);\r\n            if (!wps.Application.Selection.Find.Execute(value)) {\r\n                console.log(\"no\");\r\n                break\r\n            }\r\n            let sel = wps.Application.Selection.Font;\r\n            // sel.Bold=\t9999998;     //切换属性\r\n            sel.Bold = toBold;\r\n            sel.Italic = toItalic;\r\n            sel.Underline = toUnderline;\r\n            console.log(++counts)\r\n        }\r\n    }\r\n    else {\r\n        console.log(wps.Application.ActiveDocument.Content.Text);\r\n        console.log(counts + 1)\r\n        wps.Application.Selection.Find.Execute(value)\r\n        wps.Application.Selection.Find.Wrap = 1;\r\n    }\r\n}\r\nfunction replace_main(word, replaceWord, doc) {\r\n\r\n    var doc_split = doc.split(\"w:p>\")                                       //将xml文件以段落分组\r\n    var newPara = [];\r\n    var para_isodd = false                                                  //判断循环是否处于奇数\r\n    for (var i = 0; i < doc_split.length; i++) {\r\n        if (para_isodd && i !== doc_split.length - 1) {\r\n            newPara[i] = getNewXml(doc_split[i], word, replaceWord)        //如果为含有文本的内容，则进入getNewXml函数，获取每段的新的xml存入一个数组中\r\n            para_isodd = false\r\n        }\r\n        else if (!para_isodd && i !== doc_split.length - 1) {\r\n\r\n            newPara[i] = doc_split[i] + \"w:p>\"                             //否则，直接添加进新段落数组中\r\n            para_isodd = true\r\n        }\r\n        else {\r\n            newPara[i] = doc_split[i]                                       //若为最后一个，则为一些配置属性，直接添加\r\n        }\r\n    }\r\n\r\n    var finalParaXml = \"\"\r\n    for (let i = 0; i < newPara.length; i++) {\r\n        finalParaXml += newPara[i]                              //将每段内容拼接起来得到段落部分的xml\r\n    }\r\n    var FinalXml = \"\"\r\n\r\n    FinalXml += finalParaXml       //将原始头部和尾部与段落部分拼接起来，得到最终xml\r\n\r\n    // console.log(FinalXml)\r\n\r\n\r\n    //以下为写入文件部分\r\n    let wpsapp = wps.WpsApplication();\r\n    let docName = wpsapp.ActiveDocument.FullName;\r\n    let needbeDelte = false;\r\n    // if (!wps.FileSystem.Exists(docName)) {\r\n    //     // let TempPath = wps.Env.GetTempPath() + \"\\\\TempDoc\";  // wpsapp.NormalTemplate.Path;\r\n    //     // let TempPath_forall = TempPath.split(\"/\").join(\"\\\\\")\r\n    //     // if (!wps.FileSystem.Exists(TempPath_forall)) {\r\n    //     //     wps.FileSystem.Mkdir(TempPath_forall);\r\n    //     // }\r\n    //     // // docName = TempPath + \"\\\\TempDoc.docx\"; //linux下分隔符可能有问题\r\n    //     // let newdoc = wps.WpsApplication().Documents.Add(null, null, 0, false);\r\n    //     // newdoc.Range(0, 0).InsertXML(FinalXml);\r\n    //     // needbeDelte = true;\r\n    //     // console.log(TempPath_forall + \"\\\\\" + docName)\r\n    //     // newdoc.SaveAs2(TempPath_forall + \"\\\\\" + docName, 12, null, null, false);\r\n    //     // newdoc.Close(false);\r\n    //     wpsapp.ActiveDocument.Content.Select()\r\n    //     wpsapp.Selection.Range.Delete()\r\n    //     wpsapp.ActiveDocument.Range(0, 0).InsertXML(FinalXml);\r\n    // }\r\n    // else{\r\n    //     wpsapp.ActiveDocument.Content.Select()\r\n    //     wpsapp.Selection.Range.Delete()\r\n    //     wpsapp.ActiveDocument.Range(0, 0).InsertXML(FinalXml);\r\n    // }\r\n        wpsapp.ActiveDocument.Content.Select()\r\n        wpsapp.Selection.Range.Delete()\r\n        wpsapp.ActiveDocument.Range(0, 0).InsertXML(FinalXml);\r\n    try {\r\n        if (needbeDelte === true) {\r\n            try {\r\n                wps.FileSystem.Remove(docName);\r\n            } catch (err) { }\r\n        }\r\n    } catch (err) { }\r\n}\r\n\r\n\r\n//第一个参数为按照段落拆分的xml文本，Word为需要替换的文字，replaceWord为替换成的内容\r\nfunction getNewXml(doc_split, word, replaceWord) {\r\n    var txt = [];              //存储Word文档中的文字\r\n    var newdocxml = [];           //存储每段拆分后的xml\r\n    if (doc_split.split(/w:t>|w:t xml:space=\"preserve\">/).length === 1) {                //如果没有文本内容，不做修改\r\n        return doc_split + \"w:p>\"\r\n    }\r\n    for (var i = 0; i < (doc_split.split(/w:t>|w:t xml:space=\"preserve\">/).length - 1) / 2; i++) {\r\n        if (doc_split.split(/w:t>|w:t xml:space=\"preserve\">/)[1 + 2 * i]) {\r\n            if (doc_split.split(/w:t>|w:t xml:space=\"preserve\">/)[1 + 2 * i].length > 2) {\r\n                if (doc_split) {\r\n                    newdocxml.push(doc_split.slice(0, -2))                                                  //将拆分后的数组存储进newdocxml中\r\n                }\r\n                txt.push(doc_split.split(/w:t>|w:t xml:space=\"preserve\">/)[1 + 2 * i].slice(0, -2))         //将文本提取出来，每一个部分为数组的一个值\r\n            }\r\n            else {\r\n                console.log(\"error\")\r\n            }\r\n        }\r\n    }\r\n    // console.log(txt)\r\n\r\n    var ans = replace(doc_split, word, replaceWord, txt)\r\n    // // console.log(\"getNewXml\")\r\n    return ans;\r\n}\r\n\r\n\r\n//替换，第一个参数为按照段落拆分的xml文本，Word为需要替换的文字，replaceWord为替换成的内容，txt为文字数组\r\nfunction replace(doc_split, word, replaceWord, txt) {\r\n    if (txt) {\r\n        var SingleWord = txt.join(\"\").split(\"\")                             //判断各个值是否存在，再进行单字拆分，用以后续判断替换\r\n    }\r\n    if (word) {\r\n        var word_split = word.split(\"\")\r\n    }\r\n    if (replaceWord) {\r\n        var replaceWord_split = replaceWord.split(\"\")\r\n    }\r\n    for (var i = 0; i < SingleWord.length; i++) {\r\n        if (SingleWord.slice(i, i + word_split.length).join(\"\") === word_split.join(\"\")) {\r\n            if (replaceWord_split.length <= word_split.length) {                                //根据替换字与原字长度的不同形式进行替换，共两种情况\r\n                for (var j = 0; j < word_split.length; j++) {\r\n                    if (replaceWord_split !==\"\") {\r\n                        SingleWord[i + j] = replaceWord_split[j]\r\n                    }\r\n                    else {\r\n                        SingleWord[i + j] = \"\"                                                  //若替换字短于原字，后续原字替换为空白\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                for (let j = 0; j < word_split.length; j++) {\r\n                    if (j !== word_split.length - 1) {\r\n                        SingleWord[i + j] = replaceWord_split[j]\r\n                    }\r\n                    else {\r\n                        SingleWord[i + j] = replaceWord_split.slice(word_split.length - 1).join(\"\")         //长于的话，则将后续所有替换字全部存储在原字数组最后一位\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            continue\r\n        }\r\n    }\r\n\r\n    var isodd = false\r\n    var newxml = \"\"\r\n    var num = 0\r\n\r\n    for (let i = 0; i < doc_split.split(/w:t>|w:t xml:space=\"preserve\">/).length; i++) {                //将替换好的文本内容与其格式内容进行xml拼接\r\n\r\n        if (!isodd && i !== doc_split.split(/w:t>|w:t xml:space=\"preserve\">/).length - 1) {\r\n            newxml += (doc_split.split(/w:t>|w:t xml:space=\"preserve\">/)[i] + \"w:t>\")\r\n            isodd = true\r\n        }\r\n\r\n        else if (isodd && i !== doc_split.split(/w:t>|w:t xml:space=\"preserve\">/).length - 1) {          //根据文本原本不同的位置进行拼接，根据txt将文本拆分之后写入xml文件\r\n            // console.log(num + txt[(i - 1) / 2].length)\r\n            // console.log(SingleWord.slice(num, num + txt[(i - 1) / 2].length).indexOf(\" \"))\r\n            if (SingleWord.slice(num, num + txt[(i - 1) / 2].length).indexOf(\" \") === -1) {\r\n                newxml += (SingleWord.slice(num, num + txt[(i - 1) / 2].length).join(\"\") + \"</w:t>\")\r\n            }\r\n            else if (SingleWord.slice(num, num + txt[(i - 1) / 2].length).indexOf(\" \") !== -1 && newxml.slice(-4) === \"w:t>\") {\r\n                newxml = newxml.slice(0, newxml.length - 5) + \"<w:t xml:space=\\\"preserve\\\">\" + (SingleWord.slice(num, num + txt[(i - 1) / 2].length).join(\"\") + \"</w:t>\")\r\n            }\r\n            else{\r\n                newxml += (SingleWord.slice(num, num + txt[(i - 1) / 2].length).join(\"\") + \"</w:t>\")\r\n            }\r\n            num += txt[(i - 1) / 2].length\r\n            isodd = false\r\n        }\r\n        else {\r\n            newxml += \"</w:r></w:p>\"\r\n        }\r\n    }\r\n    return newxml;\r\n}\r\n\r\n\r\nexport default { handleSearch, Macro3, replace_main };","import { Input, Space } from 'antd';\r\n\r\nimport React, { Component } from 'react';\r\nimport Handle from './handleSearch';\r\nconst { Search } = Input;\r\n/* global wps:false */\r\n\r\n\r\n\r\nfunction fun() {\r\n    var obj = document.getElementsByName(\"test\");\r\n    var check_val = [];\r\n    for (var k in obj) {\r\n        if (obj[k].checked) {\r\n            check_val.push(obj[k].value);\r\n        }\r\n    }\r\n    console.log(check_val)\r\n    return check_val;\r\n}\r\n\r\n\r\nclass SearchInput extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            isChecked: false\r\n        }\r\n        this.Replace = this.Replace.bind(this);\r\n        this.onSearch = this.onSearch.bind(this);\r\n    }\r\n    onSearch = value => {\r\n        console.log(value);\r\n        console.log(this.state.isChecked)\r\n        var check_val=null;\r\n        if(this.state.isChecked){\r\n            check_val=fun();\r\n        }\r\n         Handle.Macro3(value, this.state.isChecked,check_val);\r\n    }\r\n\r\n\r\n\r\n    Replace = value => {\r\n\r\n        var Word = String(document.getElementById(\"word\").value)\r\n        var replace = String(document.getElementById(\"replaceword\").value)\r\n        var doc = wps.WpsApplication().ActiveDocument.WordOpenXML\r\n        console.log(doc)\r\n        if(Word && replace)\r\n        {\r\n            Handle.replace_main(Word, replace, doc)\r\n        }\r\n        else\r\n        {\r\n            console.log(\"未输入替换关键字\")\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <div>\r\n                    <span>批量替换</span>\r\n                </div>\r\n                <Space direction=\"horizontal\">\r\n                    <input placeholder=\"word search text\" id=\"word\" style={{ width: 200 }} />\r\n                </Space>\r\n                <br />\r\n                <Space direction=\"horizontal\">\r\n                    <Search placeholder=\"replace search text\" id=\"replaceword\" onSearch={this.Replace} style={{ width: 200 }} />\r\n                </Space>\r\n\r\n            </div>\r\n\r\n        )\r\n    }\r\n}\r\n\r\nexport default SearchInput;","import React, { Component } from 'react';\r\n \r\nimport {\r\n    TranslationOutlined,QuestionOutlined\r\n} from '@ant-design/icons';\r\nimport { Avatar } from 'antd';\r\nimport handle from './iconEvent'\r\nimport SearchInput from '../../replaceSearch';\r\n\r\nclass expand extends Component {\r\n\r\n    handleClick(param) {\r\n        // console.log(param)\r\n        handle(param)\r\n    }\r\n    render() {\r\n        return (\r\n            <div>\r\n                <div\r\n                    style={{ margin: '10px 10px 50px 10px', padding: '10px' }}>\r\n                    <h2>拓展功能</h2><br />\r\n                    <SearchInput />\r\n                    <br />\r\n                    <br />\r\n                    <Avatar size={35} icon={<TranslationOutlined />} onClick={this.handleClick.bind(this, \"中英文标点匹配\")} />\r\n                    <span>&nbsp;&nbsp;</span>\r\n                    <Avatar size={20} icon={<QuestionOutlined onClick={this.handleClick.bind(this, \"帮助2\")} />} />\r\n                    <span>帮助</span>\r\n                    <br />\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default expand;"],"sourceRoot":""}